(function(e){function t(t){for(var n,a,s=t[0],u=t[1],c=t[2],l=0,d=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);p&&p(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,a=1;a<r.length;a++){var s=r[a];0!==i[s]&&(n=!1)}n&&(o.splice(t--,1),e=u(u.s=r[0]))}return e}var n={},a={app:0},i={app:0},o=[];function s(e){return u.p+"js/"+({menus:"menus"}[e]||e)+"."+{menus:"10966444"}[e]+".js"}function u(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,u),r.l=!0,r.exports}u.e=function(e){var t=[],r={menus:1};a[e]?t.push(a[e]):0!==a[e]&&r[e]&&t.push(a[e]=new Promise((function(t,r){for(var n="css/"+({menus:"menus"}[e]||e)+"."+{menus:"45dbf25a"}[e]+".css",i=u.p+n,o=document.getElementsByTagName("link"),s=0;s<o.length;s++){var c=o[s],l=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(l===n||l===i))return t()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){c=d[s],l=c.getAttribute("data-href");if(l===n||l===i)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete a[e],p.parentNode.removeChild(p),r(o)},p.href=i;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){a[e]=0})));var n=i[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=o);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=s(e);var d=new Error;c=function(t){l.onerror=l.onload=null,clearTimeout(p);var r=i[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",d.name="ChunkLoadError",d.type=n,d.request=a,r[1](d)}i[e]=void 0}};var p=setTimeout((function(){c({type:"timeout",target:l})}),12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return Promise.all(t)},u.m=e,u.c=n,u.d=function(e,t,r){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(u.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)u.d(r,n,function(t){return e[t]}.bind(null,n));return r},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/static/app/",u.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var p=l;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"0685":function(e,t,r){},"0f2e":function(e,t,r){"use strict";r("d81d"),r("07ac"),r("159b");var n=r("d4ec"),a=r("bee2");r("a630"),r("ace4"),r("d3b7"),r("3ca3"),r("5cc6"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a9"),r("72f7");function i(e){var t=new Uint8Array(e),r=String.fromCharCode.apply(null,Array.from(t));return decodeURIComponent(escape(r))}var o=function(){function e(){Object(n["a"])(this,e),this.error=null,this.message=null,this.spin=!1}return Object(a["a"])(e,[{key:"getError",value:function(){return this.error}},{key:"getMessage",value:function(){return this.message}},{key:"getSpin",value:function(){return this.spin}},{key:"startSpin",value:function(){this.spin=!0}},{key:"setMessage",value:function(e){this.spin=!1,this.message=e}},{key:"setError",value:function(e){this.spin=!1,this.error=e}},{key:"parseAxiosError",value:function(e){var t,r,n=null;if(e.response){if(t="Erreur côté serveur",n=e.response.status,r=e.response.data.message,!r)try{var a=i(e.response.data);r=JSON.parse(a).message}catch(e){r="Le format d'erreur du serveur n'a pu être décodé.<br/>\n        Détails : <i>".concat(e,"</i>")}}else e.request?(t="Aucune réponse du serveur",r="La requête a bien été envoyée, mais le serveur n'a donné aucune réponse..."):(t="Erreur du client",r="La requête n'a pu être mise en place. <br/>\n                  Détails :  ".concat(e.message," "));return{kind:t,messageHtml:r,code:n}}},{key:"setAxiosError",value:function(e){this.error=this.parseAxiosError(e),this.spin=!1}}]),e}(),s=(r("96cf"),r("1da1")),u=r("bc3a"),c=r.n(u),l=(r("99af"),r("ddb0"),r("2b0e")),d=!1,p=d?"http://localhost:1323":window.location.origin,f=p+"/api",v=function(){function e(t){var r=this;Object(n["a"])(this,e),this.agenda={sejours:{}},this.ingredients={},this.recettes={},this.menus={},this.utilisateurs={},this.loadUtilisateurs=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.get(f+"/utilisateurs",{auth:r.controller.auth()});case 4:t=e.sent,r.controller.token=t.data.token,r.utilisateurs=t.data.utilisateurs,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.loadIngredients=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.get(f+"/ingredients",{auth:r.controller.auth()});case 4:t=e.sent,r.controller.token=t.data.token,r.ingredients=t.data.ingredients,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.createOrUpdateIngredient=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),a="put"==n?c.a.put:c.a.post,e.prev=2,e.next=5,a(f+"/ingredients",t,{auth:r.controller.auth()});case 5:return i=e.sent,l["a"].set(r.ingredients,i.data.ingredient.id,i.data.ingredient),r.controller.token=i.data.token,e.abrupt("return",i.data.ingredient);case 11:e.prev=11,e.t0=e["catch"](2),r.controller.notifications.setAxiosError(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,r){return e.apply(this,arguments)}}(),this.createIngredient=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateIngredient(t,"put"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateIngredient=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateIngredient(t,"post"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteIngredient=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.delete(f+"/ingredients",{params:{id:t.id,check_produits:n?"check":""},auth:r.controller.auth()});case 4:a=e.sent,r.ingredients=a.data.ingredients,r.controller.token=a.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,r){return e.apply(this,arguments)}}(),this.loadRecettes=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.get(f+"/recettes",{auth:r.controller.auth()});case 4:t=e.sent,r.controller.token=t.data.token,r.recettes=t.data.recettes,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.createOrUpdateRecette=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),a="put"==n?c.a.put:c.a.post,e.prev=2,e.next=5,a(f+"/recettes",t,{auth:r.controller.auth()});case 5:return i=e.sent,l["a"].set(r.recettes,i.data.recette.id,i.data.recette),r.controller.token=i.data.token,e.abrupt("return",i.data.recette);case 11:e.prev=11,e.t0=e["catch"](2),r.controller.notifications.setAxiosError(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,r){return e.apply(this,arguments)}}(),this.createRecette=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateRecette(t,"put"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateRecette=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateRecette(t,"post"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteRecette=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.delete(f+"/recettes",{params:{id:t.id},auth:r.controller.auth()});case 4:n=e.sent,r.recettes=n.data.recettes,r.controller.token=n.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.loadMenus=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.get(f+"/menus",{auth:r.controller.auth()});case 4:t=e.sent,r.controller.token=t.data.token,r.menus=t.data.menus,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.createOrUpdateMenu=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),a="put"==n?c.a.put:c.a.post,e.prev=2,e.next=5,a(f+"/menus",t,{auth:r.controller.auth()});case 5:return i=e.sent,l["a"].set(r.menus,i.data.menu.id,i.data.menu),r.controller.token=i.data.token,e.abrupt("return",i.data.menu);case 11:e.prev=11,e.t0=e["catch"](2),r.controller.notifications.setAxiosError(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,r){return e.apply(this,arguments)}}(),this.createMenu=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateMenu(t,"put"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateMenu=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateMenu(t,"post"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteMenu=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.delete(f+"/menus",{params:{id:t.id},auth:r.controller.auth()});case 4:n=e.sent,r.menus=n.data.menus,r.controller.token=n.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.loadAgenda=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.get(f+"/agenda",{auth:r.controller.auth()});case 4:t=e.sent,r.controller.token=t.data.token,r.agenda=t.data.agenda,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.createOrUpdateSejour=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var a,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),a="put"==n?c.a.put:c.a.post,e.prev=2,e.next=5,a(f+"/sejours",t,{auth:r.controller.auth()});case 5:return i=e.sent,o=r.agenda.sejours[i.data.sejour.id]||{journees:[],sejour:i.data.sejour},o.sejour=i.data.sejour,l["a"].set(r.agenda.sejours,i.data.sejour.id,o),r.controller.token=i.data.token,e.abrupt("return",i.data.sejour);case 13:e.prev=13,e.t0=e["catch"](2),r.controller.notifications.setAxiosError(e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t,r){return e.apply(this,arguments)}}(),this.createSejour=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateSejour(t,"put"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.updateSejour=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",r.createOrUpdateSejour(t,"post"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteSejour=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.delete(f+"/sejours",{params:{id:t.id},auth:r.controller.auth()});case 4:n=e.sent,r.agenda=n.data.agenda,r.controller.token=n.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.createRepas=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.put(f+"/sejours/repas",t,{auth:r.controller.auth()});case 4:n=e.sent,r.agenda=n.data.agenda,r.controller.token=n.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.updateManyRepas=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.post(f+"/sejours/repas",t,{auth:r.controller.auth()});case 4:n=e.sent,r.agenda=n.data.agenda,r.controller.token=n.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.deleteRepas=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r.controller.notifications.startSpin(),e.prev=1,e.next=4,c.a.delete(f+"/sejours/repas",{params:{id:t.id},auth:r.controller.auth()});case 4:n=e.sent,r.agenda=n.data.agenda,r.controller.token=n.data.token,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.controller.notifications.setAxiosError(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),this.controller=t}return Object(a["a"])(e,[{key:"loadAllMenus",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.loadIngredients(),this.loadUtilisateurs()]);case 2:return e.next=4,this.loadRecettes();case 4:return e.next=6,this.loadMenus();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getSejour",value:function(e){var t=this.agenda.sejours[e];return t||this.controller.notifications.setError({code:null,kind:"Séjour introuvable",messageHtml:"Le séjour concerné (id ".concat(e,") est <i>introuvable<i> <br/>\n              Il s'agit probablement d'une erreur de synchronisation avec le serveur. <br/>\n              Pour la corriger, merci de <b>recharger la page</b>.")}),t}},{key:"getOffset",value:function(e,t){var r=new Date(e.date_debut);if(!(t<r)){var n=Math.ceil((t.valueOf()-r.valueOf())/864e5);return n}this.controller.notifications.setError({code:null,kind:"Jour invalide",messageHtml:"La date ciblée (".concat(t.toLocaleDateString(),") est <i>antérieure</i> au début du séjour.<br/>\n                    Si vous souhaitez déplacer un repas sur cette journée, \n                    veuillez d'abord <b>modifier la date de début</b> du séjour <b>").concat(e.nom,"</b>")})}},{key:"switchDays",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r,n){var a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.getSejour(t),a){e.next=3;break}return e.abrupt("return");case 3:if(i=this.getOffset(a.sejour,n),void 0!==i){e.next=6;break}return e.abrupt("return");case 6:if(o=this.getOffset(a.sejour,r),void 0!==o){e.next=9;break}return e.abrupt("return");case 9:if(o!=i){e.next=11;break}return e.abrupt("return");case 11:if(s=(a.journees[o]||{menus:[]}).menus||[],u=(a.journees[i]||{menus:[]}).menus||[],s.forEach((function(e){return e.jour_offset=i})),u.forEach((function(e){return e.jour_offset=o})),c=s.concat(u),0!==c.length){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,this.updateManyRepas(c);case 20:null===this.controller.notifications.getError()&&this.controller.notifications.setMessage("Les journées ont étés échangées avec succès.");case 21:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"deplaceRepas",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.getSejour(t.id_sejour),a){e.next=3;break}return e.abrupt("return");case 3:if(i=this.getOffset(a.sejour,r),void 0!==i){e.next=6;break}return e.abrupt("return");case 6:return t.jour_offset=i,t.horaire=n,e.next=10,this.updateManyRepas([t]);case 10:null===this.controller.notifications.getError()&&this.controller.notifications.setMessage("Le repas a été déplacé avec succès.");case 11:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()}]),e}(),h=function(){function e(t){Object(n["a"])(this,e),this.controller=t}return Object(a["a"])(e,[{key:"resoudIngredients",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.a.post(f+"/resolution",t,{auth:this.controller.auth()});case 3:return r=e.sent,this.controller.token=r.data.token,e.abrupt("return",r.data);case 8:e.prev=8,e.t0=e["catch"](0),this.controller.notifications.setAxiosError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"resoudIngredientsRepas",value:function(e,t){var r={mode:"repas",id_repas:e,nb_personnes:void 0==t?-1:t,id_sejour:-1,jour_offset:[]};return this.resoudIngredients(r)}},{key:"resoudIngredientsSejour",value:function(e){var t={mode:"journees",id_repas:-1,nb_personnes:-1,id_sejour:e,jour_offset:null};return this.resoudIngredients(t)}},{key:"resoudIngredientsJournees",value:function(e,t){var r={mode:"journees",id_repas:-1,nb_personnes:-1,id_sejour:e,jour_offset:t};return this.resoudIngredients(r)}}]),e}(),m=r("ad05"),g=r("a78e"),b=r.n(g),j=function(){function e(t){Object(n["a"])(this,e),this.controller=t}return Object(a["a"])(e,[{key:"checkCookies",value:function(){var e=b.a.get("token"),t=b.a.get("id_utilisateur");return void 0==e||void 0==t?null:{token:e,idUtilisateur:t}}},{key:"loggin",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.a.post(f+"/loggin",t);case 3:if(r=e.sent,""==r.data.erreur){e.next=6;break}return e.abrupt("return",r.data.erreur);case 6:this.controller.token=r.data.token,this.controller.idUtilisateur=r.data.utilisateur.id,this.controller.notifications.setMessage("Connecté sous le nom de <b>".concat(r.data.utilisateur.prenom_nom,"</b>")),this.controller.isLoggedIn=!0,e.next=15;break;case 12:return e.prev=12,e.t0=e["catch"](0),e.abrupt("return",this.controller.notifications.setAxiosError(e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){this.controller.isLoggedIn=!1}}]),e}();r.d(t,"a",(function(){return w}));var k=function(){function e(){Object(n["a"])(this,e),this.isLoggedIn=d,this.token="",this.idUtilisateur=d?2:null,this.data=new v(this),this.notifications=new o,this.calculs=new h(this),this.formatter=new m["a"](this),this.logger=new j(this)}return Object(a["a"])(e,[{key:"auth",value:function(){return{username:String(this.idUtilisateur||""),password:this.token}}},{key:"getAllIngredients",value:function(){return Object.values(this.data.ingredients).map((function(e){return{ingredient:e}}))}},{key:"getMenuRecettes",value:function(e){var t=this;return(e.recettes||[]).map((function(e){return t.data.recettes[e.id_recette]}))}},{key:"getMenuIngredients",value:function(e){var t=this;return(e.ingredients||[]).map((function(e){return{ingredient:t.data.ingredients[e.id_ingredient],options:e}}))}},{key:"getMenuOrRecetteProprietaire",value:function(e){return e.id_proprietaire.Valid?this.data.utilisateurs[e.id_proprietaire.Int64]:null}},{key:"getRecetteIngredients",value:function(e){var t=this;return(e.ingredients||[]).map((function(e){return{ingredient:t.data.ingredients[e.id_ingredient],options:e}}))}},{key:"iterateAllRepas",value:function(e){Object.values(this.data.agenda.sejours).forEach((function(t){Object.values(t.journees).forEach((function(r){r.menus&&r.menus.forEach((function(r){e(t.sejour,r)}))}))}))}}]),e}(),w=new k},"1c9b":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r("v-btn",e._g({attrs:{disabled:e.disabled,icon:""},on:{click:function(t){return e.$emit("click",t)}}},n),[r("v-icon",{attrs:{color:e.color}},[e._v("mdi-"+e._s(e.mdiIcon))])],1)]}}])},[r("div",{domProps:{innerHTML:e._s(e.tooltip)}})])},a=[],i=r("d4ec"),o=r("99de"),s=r("7e84"),u=r("262e"),c=r("9ab4"),l=r("2b0e"),d=r("2fe1"),p=l["a"].extend({props:{tooltip:String,mdiIcon:String,color:{type:String,default:"black"},disabled:{type:Boolean,default:!1}}}),f=function(e){function t(){return Object(i["a"])(this,t),Object(o["a"])(this,Object(s["a"])(t).apply(this,arguments))}return Object(u["a"])(t,e),t}(p);f=Object(c["a"])([d["b"]],f);var v=f,h=v,m=r("2877"),g=r("6544"),b=r.n(g),j=r("8336"),k=r("132d"),w=r("3a2f"),y=Object(m["a"])(h,n,a,!1,null,null,null);t["a"]=y.exports;b()(y,{VBtn:j["a"],VIcon:k["a"],VTooltip:w["a"]})},ad05:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("99af"),r("a15b"),r("d81d"),r("a9e3"),r("b680");var n=r("d4ec"),a=r("bee2"),i=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],o=function(){function e(t){var r=this;Object(n["a"])(this,e),this.formatRepasName=function(e){var t=r.controller.data.menus[e.id_menu],n=t?r.formatMenuName(t):"";return" (".concat(e.nb_personnes,") - ").concat(n)},this.formatMenuName=function(e){var t=r.controller.getMenuRecettes(e);return 0==t.length?"(".concat(e.id,")"):t.map((function(e){return e.nom||""})).join(", ")},this.formatMenuOrRecetteProprietaire=function(e){var t=r.controller.getMenuOrRecetteProprietaire(e);return null==t?"public":t.id==r.controller.idUtilisateur?"vous appartient":"appartient à ".concat(t.prenom_nom)},this.controller=t}return Object(a["a"])(e,[{key:"offsetToDate",value:function(e,t){var r=this.controller.data.agenda.sejours[e].sejour,n=new Date(r.date_debut);return n.setDate(n.getDate()+t),n}}],[{key:"horaireToTime",value:function(e){return("00"+e.heure).substr(-2,2)+":"+("00"+e.minute).substr(-2,2)}},{key:"formatDate",value:function(e){if(e=e||"",e.length<10||"0001-01-01"==e.substr(0,10))return null;var t=e.substr(0,4),r=Number(e.substr(5,2)),n=e.substr(8,2);return"".concat(n," ").concat(i[r-1]," ").concat(t)}},{key:"formatQuantite",value:function(e){return e.toFixed(2)}}]),e}()},b038:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return i}));var n="P",a=[{text:"Litres",value:"L"},{text:"Kilos",value:"Kg"},{text:"Pièces",value:n}],i=[{text:"Petit déjeuner",value:{heure:8,minute:0}},{text:"Midi",value:{heure:12,minute:15}},{text:"Goûter",value:{heure:16,minute:30}},{text:"Diner",value:{heure:19,minute:0}},{text:"Cinquième",value:{heure:21,minute:30}}]},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-app-bar",{attrs:{app:"",color:"primary",dense:e.isLoggedIn}},[r("v-toolbar-title",{staticClass:"headline text-uppercase"},[r("v-tooltip",{scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r("span",e._g({},n),[e._v(e._s(e.mainTitle))])]}}])},[e._v(" Version "+e._s(e.version)+" ")])],1)],1),r("navigation-bar",{attrs:{"is-logged-in":e.isLoggedIn},on:{logout:e.logout}}),r("v-content",[e.isLoggedIn?r("keep-alive",[r("router-view")],1):r("loggin"),r("spinner-snackbar"),r("error-dialog"),r("success-snackbar")],1)],1)},i=[],o=r("d4ec"),s=r("bee2"),u=r("99de"),c=r("7e84"),l=r("262e"),d=r("9ab4"),p=r("2fe1"),f=r("60a3"),v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-dialog",{attrs:{"max-width":"500"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("v-card",[r("v-card-title",{staticClass:"title error"},[r("v-row",[r("v-col",{attrs:{cols:"7"}},[e._v(e._s(e.mainTitle))]),r("v-col",{staticClass:"text-right",attrs:{cols:"5"}},[r("small",[e._v(e._s(e.subTitle))])])],1)],1),r("v-card-text",{staticClass:"pa-3"},[r("div",{staticClass:"subtitle-2",domProps:{innerHTML:e._s(e.message)}})])],1)],1)},h=[],m=r("0f2e"),g=function(e){function t(){return Object(o["a"])(this,t),Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"show",get:function(){return null!=m["a"].notifications.getError()},set:function(e){e||m["a"].notifications.setError(null)}},{key:"mainTitle",get:function(){var e=m["a"].notifications.getError();return null==e?"":e.kind}},{key:"subTitle",get:function(){var e=m["a"].notifications.getError();return e&&null!=e.code?"code ".concat(e.code):""}},{key:"message",get:function(){var e=m["a"].notifications.getError()||{messageHtml:""};return e.messageHtml}}]),t}(n["a"]);g=Object(d["a"])([p["b"]],g);var b=g,j=b,k=r("2877"),w=r("6544"),y=r.n(w),O=r("b0af"),x=r("99d9"),_=r("62ad"),S=r("169a"),R=r("0fd9"),C=Object(k["a"])(j,v,h,!1,null,null,null),E=C.exports;y()(C,{VCard:O["a"],VCardText:x["b"],VCardTitle:x["c"],VCol:_["a"],VDialog:S["a"],VRow:R["a"]});var D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-snackbar",{attrs:{bottom:"",right:"",timeout:6e3,color:"success"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"2","align-self":"center"}},[r("i",[e._v("("+e._s(e.currentTime())+")")])]),r("v-col",{attrs:{cols:"9","align-self":"center"}},[r("span",{domProps:{innerHTML:e._s(e.message)}})]),r("v-col",{attrs:{cols:"1"}},[r("v-btn",{staticClass:"mx-0",attrs:{color:"black",text:"",icon:""},on:{click:function(t){e.show=!1}}},[r("v-icon",[e._v("mdi-close")])],1)],1)],1)],1)},V=[],I=(r("99af"),function(e){function t(){return Object(o["a"])(this,t),Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"currentTime",value:function(){var e=new Date,t=("00"+e.getMinutes()).substr(-2,2);return"".concat(e.getHours(),":").concat(t)}},{key:"show",get:function(){return null!=m["a"].notifications.getMessage()},set:function(e){e||m["a"].notifications.setMessage(null)}},{key:"message",get:function(){return m["a"].notifications.getMessage()}}]),t}(n["a"]));I=Object(d["a"])([p["b"]],I);var T=I,P=T,M=r("8336"),A=r("132d"),L=r("2db4"),N=Object(k["a"])(P,D,V,!1,null,null,null),$=N.exports;y()(N,{VBtn:M["a"],VCol:_["a"],VIcon:A["a"],VRow:R["a"],VSnackbar:L["a"]});var F=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-snackbar",{attrs:{bottom:"",right:"",timeout:0},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[r("i",[e._v("Mise à jour...")]),r("v-progress-linear",{attrs:{color:"orange",indeterminate:""}})],1)},J=[],U=function(e){function t(){return Object(o["a"])(this,t),Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"show",get:function(){return m["a"].notifications.getSpin()},set:function(e){}}]),t}(n["a"]);U=Object(d["a"])([p["b"]],U);var B=U,H=B,q=r("8e36"),z=Object(k["a"])(H,F,J,!1,null,null,null),W=z.exports;y()(z,{VProgressLinear:q["a"],VSnackbar:L["a"]});var Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isLoggedIn?n("v-navigation-drawer",{attrs:{app:"","mini-variant":e.menuMini,permanent:""}},[n("v-layout",{attrs:{"align-center":"","justify-center":"",row:""}},[n("v-avatar",{attrs:{size:"50"},on:{click:function(t){e.menuMini=!e.menuMini}}},[n("v-img",{attrs:{margin:"auto",src:r("cf05")}})],1)],1),n("v-list",[e._l(e.routes,(function(t){return n("v-list-item",{key:t.name,attrs:{router:"",to:t.path}},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(r){var a=r.on;return[n("v-list-item-action",e._g({},a),[n("v-icon",[e._v(e._s(t.meta.icon))])],1)]}}],null,!0)},[e._v(" "+e._s(t.meta.tooltip)+" ")]),n("v-list-item-content",[e._v(e._s(t.meta.title))])],1)})),n("v-divider"),n("v-list-item",{on:{click:function(t){return e.$emit("logout")}}},[n("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-list-item-action",e._g({},r),[n("v-icon",[e._v("mdi-logout")])],1)]}}],null,!1,449162385)},[e._v(" Se déconnecter ")]),n("v-list-item-content",[e._v("Se déconnecter")])],1)],2)],1):e._e()},Y=[],K=(r("d3b7"),r("8c4f")),Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{fluid:""}},[r("calendar",{ref:"calendar"})],1)},X=[],G=(r("96cf"),r("1da1")),ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"weeks",staticClass:"two-weeks-calendar"},[r("v-dialog",{attrs:{"max-width":"800"},model:{value:e.showPreferences,callback:function(t){e.showPreferences=t},expression:"showPreferences"}},[r("form-preferences",{model:{value:e.preferences,callback:function(t){e.preferences=t},expression:"preferences"}})],1),r("v-dialog",{attrs:{"max-width":"500"},model:{value:e.showEditFormSejour,callback:function(t){e.showEditFormSejour=t},expression:"showEditFormSejour"}},[r("form-sejour",{attrs:{initialSejour:e.getInitialCurrentSejour()},on:{accept:e.onEditSejourDone}})],1),r("v-dialog",{attrs:{"max-width":"500"},model:{value:e.showEditFormRepas,callback:function(t){e.showEditFormRepas=t},expression:"showEditFormRepas"}},[r("form-repas",{attrs:{initialRepas:e.editedRepas,mode:e.editMode},on:{accept:e.onEditRepasDone,delete:e.deleteRepas}})],1),r("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.showConfirmeSupprime,callback:function(t){e.showConfirmeSupprime=t},expression:"showConfirmeSupprime"}},[r("v-card",[r("v-card-title",{attrs:{"primary-title":"",color:"warning"}},[e._v(" Confirmer la suppression ")]),r("v-card-text",[e._v(" Confirmez-vous la suppression du séjour "),r("b",[e._v(e._s((e.getCurrentSejour()||{}).nom))]),e._v(" ? ")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{tile:"",color:"warning"},on:{click:e.supprimeSejour}},[e._v("Supprimer")])],1)],1)],1),r("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.showFormCalcul,callback:function(t){e.showFormCalcul=t},expression:"showFormCalcul"}},[r("form-calcul",{attrs:{"initial-sejour":e.currentSejour}})],1),r("v-toolbar",{staticClass:"calendar-toolbar mb-1"},[r("v-toolbar-title",[e._v("Séjours")]),r("v-spacer"),r("v-toolbar-items",[r("tooltip-btn",{attrs:{tooltip:"Calculer les ingrédients nécessaires...","mdi-icon":"food-variant"},on:{click:function(t){e.showFormCalcul=!0}}}),r("v-divider",{attrs:{vertical:""}}),r("tooltip-btn",{attrs:{tooltip:"Ajouter un séjour...","mdi-icon":"shape-rectangle-plus"},on:{click:function(t){e.editMode="new",e.showEditFormSejour=!0}}}),r("v-divider",{attrs:{vertical:""}}),r("select-sejour",{attrs:{label:"Séjour actif"},model:{value:e.currentSejour,callback:function(t){e.currentSejour=e._n(t)},expression:"currentSejour"}}),r("tooltip-btn",{attrs:{disabled:!e.currentSejour,tooltip:"Modifier les paramètres du séjour...","mdi-icon":"pencil"},on:{click:function(t){e.editMode="edit",e.showEditFormSejour=!0}}}),r("tooltip-btn",{attrs:{disabled:!e.currentSejour,tooltip:"Supprimer le séjour...","mdi-icon":"close",color:"red"},on:{click:function(t){e.showConfirmeSupprime=!0}}}),r("v-divider",{attrs:{vertical:""}}),r("tooltip-btn",{attrs:{tooltip:"Préférences d'affichage...","mdi-icon":"settings"},on:{click:function(t){e.showPreferences=!0}}})],1)],1),r("v-calendar",{attrs:{type:"week",locale:"fr","event-height":22,"short-weekdays":!1,"first-interval":e.firstInterval,"interval-count":e.intervalCount,"interval-minutes":e.intervalMinutes,"interval-height":e.intervalHeight,"interval-style":e.intervalStyle,start:e.startWeek1,weekdays:e.weekdays,events:e.events,"event-color":e.getEventColor},on:{"mousedown:time":e.registerTime,"click:time":e.startAddRepas},scopedSlots:e._u([{key:"event",fn:function(t){var n=t.event;return[r("div",{style:{fontWeight:n.repas.id_sejour==e.currentSejour?"bold":""},attrs:{"data-repas":n.dataRepas},on:{click:function(t){return t.stopPropagation(),e.startEditRepas(n.repas)}}},[e._v(" "+e._s(n.name)+" ")])]}},{key:"day-header",fn:function(e){var t=e.date;return[r("div",{attrs:{"data-day":t}})]}},{key:"interval",fn:function(){return[r("div",{staticClass:"dragover",on:{dragover:function(t){return e.onDragover(t,"repas")},drop:function(t){return e.onDrop(t,"repas")}}})]},proxy:!0}])}),r("v-calendar",{staticClass:"mt-1",attrs:{type:"week",locale:"fr","event-height":22,"short-weekdays":!1,"first-interval":e.firstInterval,"interval-count":e.intervalCount,"interval-minutes":e.intervalMinutes,"interval-height":e.intervalHeight,"interval-style":e.intervalStyle,start:e.startWeek2,weekdays:e.weekdays,events:e.events,"event-color":e.getEventColor},on:{"mousedown:time":e.registerTime,"click:time":e.startAddRepas},scopedSlots:e._u([{key:"event",fn:function(t){var n=t.event;return[r("div",{style:{fontWeight:n.repas.id_sejour==e.currentSejour?"bold":""},attrs:{"data-repas":n.dataRepas},on:{click:function(t){return t.stopPropagation(),e.startEditRepas(n.repas)}}},[e._v(" "+e._s(n.name)+" ")])]}},{key:"day-header",fn:function(e){var t=e.date;return[r("div",{attrs:{"data-day":t}})]}},{key:"interval",fn:function(){return[r("div",{staticClass:"dragover",on:{dragover:function(t){return e.onDragover(t,"repas")},drop:function(t){return e.onDrop(t,"repas")}}})]},proxy:!0}])})],1)},te=[],re=(r("a4d3"),r("4de4"),r("c740"),r("caad"),r("d81d"),r("4e827"),r("a9e3"),r("e439"),r("dbb4"),r("b64b"),r("07ac"),r("2532"),r("159b"),r("ade3")),ne=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Détails du séjour ")]),r("v-card-text",[r("v-form",[r("v-text-field",{attrs:{label:"Nom du séjour",required:""},model:{value:e.sejour.nom,callback:function(t){e.$set(e.sejour,"nom",t)},expression:"sejour.nom"}}),r("date-field",{attrs:{label:"Date du premier jour"},model:{value:e.sejour.date_debut,callback:function(t){e.$set(e.sejour,"date_debut",t)},expression:"sejour.date_debut"}})],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("accept",e.sejour)}}},[e._v("Enregistrer")])],1)],1)},ae=[],ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-menu",{ref:"menuDatePicker",attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[r("v-text-field",e._g({attrs:{readonly:"",value:e.showDate(e.currentDate),label:e.label,disabled:e.disabled}},n))]}}])},[r("v-date-picker",{ref:"datePicker",attrs:{locale:"fr-fr","no-title":"",max:e.maxDate,"full-width":""},on:{change:e.save},model:{value:e.isoDate,callback:function(t){e.isoDate=t},expression:"isoDate"}})],1)},oe=[],se=r("ad05"),ue=n["a"].extend({model:{prop:"currentDate",event:"dateChanged"},props:{currentDate:String,label:String,disabled:Boolean}}),ce=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.isoDate="",e.showDate=se["a"].formatDate,e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"toDateObject",value:function(e){return e?e+"T00:00:00Z":null}},{key:"save",value:function(e){this.$refs.menuDatePicker.save(e)}},{key:"onIsoDateChanged",value:function(){var e=this.toDateObject(this.isoDate);this.$emit("dateChanged",e)}},{key:"maxDate",get:function(){var e=new Date;return e.setFullYear(e.getFullYear()+3),e.toISOString().substr(0,10)}}]),t}(ue);Object(d["a"])([Object(f["a"])("isoDate")],ce.prototype,"onIsoDateChanged",null),ce=Object(d["a"])([p["b"]],ce);var le=ce,de=le,pe=r("2e4b"),fe=r("e449"),ve=r("8654"),he=Object(k["a"])(de,ie,oe,!1,null,null,null),me=he.exports;y()(he,{VDatePicker:pe["a"],VMenu:fe["a"],VTextField:ve["a"]});var ge=n["a"].extend({props:{initialSejour:Object}}),be=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.sejour=JSON.parse(JSON.stringify(e.initialSejour)),e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"onPropChange",value:function(){this.sejour=JSON.parse(JSON.stringify(this.initialSejour))}}]),t}(ge);Object(d["a"])([Object(f["a"])("initialSejour")],be.prototype,"onPropChange",null),be=Object(d["a"])([Object(p["b"])({components:{DateField:me}})],be);var je=be,ke=je,we=r("4bd4"),ye=r("2fa4"),Oe=Object(k["a"])(ke,ne,ae,!1,null,null,null),xe=Oe.exports;y()(Oe,{VBtn:M["a"],VCard:O["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VForm:we["a"],VSpacer:ye["a"],VTextField:ve["a"]});var _e=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.showPrevisuIngredients,callback:function(t){e.showPrevisuIngredients=t},expression:"showPrevisuIngredients"}},[r("v-skeleton-loader",{attrs:{type:"card",loading:e.loadingIngredients}},[r("v-card",{staticClass:"py-2"},[r("v-card-title",{attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0"},[e._v(" Ingrédients pour "+e._s(e.repas.nb_personnes)+" personne"+e._s(e.repas.nb_personnes>1?"s":"")+" ")])]),r("div",{attrs:{height:"50vh"}},[r("liste-ingredients",{attrs:{ingredients:e.listeIngredients}})],1)],1)],1)],1),r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Détails du repas "),r("v-spacer"),r("div",[e.sejour?r("small",[e._v("Sejour : "+e._s(e.sejour.nom)+" ")]):e._e()])],1),r("v-card-text",[r("v-form",[r("v-text-field",{attrs:{label:"Nombre de personnes",type:"number"},model:{value:e.repas.nb_personnes,callback:function(t){e.$set(e.repas,"nb_personnes",e._n(t))},expression:"repas.nb_personnes"}}),r("v-autocomplete",{attrs:{label:"Menu",items:e.menus},model:{value:e.repas.id_menu,callback:function(t){e.$set(e.repas,"id_menu",t)},expression:"repas.id_menu"}}),r("v-select",{attrs:{items:e.horaires,label:"Horaire",placeholder:e.horaireFormatted},model:{value:e.repas.horaire,callback:function(t){e.$set(e.repas,"horaire",t)},expression:"repas.horaire"}})],1)],1),r("v-card-actions",["edit"==e.mode?r("v-btn",{attrs:{color:"error"},on:{click:function(t){return e.$emit("delete",e.repas)}}},[e._v("Supprimer")]):e._e(),r("v-spacer"),"edit"==e.mode?r("tooltip-btn",{attrs:{"mdi-icon":"food-variant",tooltip:"Calculer les <b>ingrédients</b> nécessaires au repas..."},on:{click:e.resoudIngredients}}):e._e(),r("v-spacer"),r("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("accept",e.repas)}}},[e._v(e._s("edit"==e.mode?"Enregistrer":"Ajouter"))])],1)],1)],1)},Se=[],Re=r("1c9b"),Ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-simple-table",{attrs:{dense:"","fixed-header":""},scopedSlots:e._u([{key:"default",fn:function(){return[r("thead",[r("tr",[r("th",{staticClass:"text-left"},[e._v("Ingrédient")]),r("th",{staticClass:"text-center"},[e._v("Quantité")])])]),r("tbody",e._l(e.ingredients,(function(t){return r("tr",{key:t.ingredient.id},[r("td",[e._v(e._s(t.ingredient.nom))]),r("td",{staticClass:"text-center"},[e._v(" "+e._s(e.formatQuantite(t.quantite))+" "),r("i",{staticClass:"grey--text"},[e._v(e._s(t.ingredient.unite))])])])})),0)]},proxy:!0}])})},Ee=[],De=n["a"].extend({props:{ingredients:Array}}),Ve=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.formatQuantite=se["a"].formatQuantite,e}return Object(l["a"])(t,e),t}(De);Ve=Object(d["a"])([Object(p["b"])({})],Ve);var Ie=Ve,Te=Ie,Pe=r("1f4f"),Me=Object(k["a"])(Te,Ce,Ee,!1,null,"3369e99c",null),Ae=Me.exports;y()(Me,{VSimpleTable:Pe["a"]});var Le=r("b038"),Ne=n["a"].extend({props:{initialRepas:Object,mode:String}}),$e=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.repas=JSON.parse(JSON.stringify(e.initialRepas)),e.horaires=Le["a"],e.showPrevisuIngredients=!1,e.loadingIngredients=!0,e.listeIngredients=[],e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"onPropChange",value:function(){this.repas=JSON.parse(JSON.stringify(this.initialRepas))}},{key:"resoudIngredients",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingIngredients=!0,this.showPrevisuIngredients=!0,e.next=4,m["a"].calculs.resoudIngredientsRepas(this.initialRepas.id,this.repas.nb_personnes);case 4:if(t=e.sent,void 0!=t&&null!=t.date_ingredients){e.next=7;break}return e.abrupt("return");case 7:this.listeIngredients=t.date_ingredients[0].ingredients||[],this.loadingIngredients=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sejour",get:function(){return m["a"].data.agenda.sejours[this.initialRepas.id_sejour].sejour}},{key:"menus",get:function(){return Object.values(m["a"].data.menus).map((function(e){return{text:m["a"].formatter.formatMenuName(e),value:e.id}}))}},{key:"horaireFormatted",get:function(){var e=this.repas.horaire;return"(Personnalisé) - ".concat(se["a"].horaireToTime(e))}}]),t}(Ne);Object(d["a"])([Object(f["a"])("initialRepas")],$e.prototype,"onPropChange",null),$e=Object(d["a"])([Object(p["b"])({components:{DateField:me,TooltipBtn:Re["a"],ListeIngredients:Ae}})],$e);var Fe=$e,Je=Fe,Ue=r("c6a6"),Be=r("b974"),He=r("3129"),qe=Object(k["a"])(Je,_e,Se,!1,null,null,null),ze=qe.exports;y()(qe,{VAutocomplete:Ue["a"],VBtn:M["a"],VCard:O["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VDialog:S["a"],VForm:we["a"],VSelect:Be["a"],VSkeletonLoader:He["a"],VSpacer:ye["a"],VTextField:ve["a"]});var We=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Préférences ")]),r("v-card-text",[r("v-switch",{attrs:{label:"Se restreindre au séjour courant","persistent-hint":"",hint:"N'afficher que le séjour actuellement sélectionné."},on:{change:e.onChange},model:{value:e.current.restrictSejourCourant,callback:function(t){e.$set(e.current,"restrictSejourCourant",t)},expression:"current.restrictSejourCourant"}}),r("v-switch",{attrs:{label:"Afficher le premier jour en tête de semaine","persistent-hint":"",hint:"Le premier jour affiché est ajusté, au lieu d'être Lundi."},on:{change:e.onChange},model:{value:e.current.startPremierJour,callback:function(t){e.$set(e.current,"startPremierJour",t)},expression:"current.startPremierJour"}})],1)],1)},Qe=[],Ye=n["a"].extend({model:{prop:"preferences",event:"change"},props:{preferences:Object}}),Ke=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.current=JSON.parse(JSON.stringify(e.preferences)),e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"onChange",value:function(){this.$emit("change",this.current)}}]),t}(Ye);Ke=Object(d["a"])([Object(p["b"])({})],Ke);var Ze=Ke,Xe=Ze,Ge=r("b73d"),et=Object(k["a"])(Xe,We,Qe,!1,null,null,null),tt=et.exports;y()(et,{VCard:O["a"],VCardText:x["b"],VCardTitle:x["c"],VSwitch:Ge["a"]});var rt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-dialog",{attrs:{"max-width":"700px"},model:{value:e.showPrevisuIngredients,callback:function(t){e.showPrevisuIngredients=t},expression:"showPrevisuIngredients"}},[r("v-skeleton-loader",{attrs:{type:"card",loading:e.loadingIngredients}},[r("v-card",[r("v-card-title",{staticClass:"secondary",attrs:{"primary-title":""}},[r("h3",{staticClass:"headline mb-0 "},[e._v(" Ingrédients nécessaires ")])]),r("date-ingredients",{attrs:{"date-ingredients":e.dateIngredients}})],1)],1)],1),r("v-card",[r("v-card-title",{attrs:{"primary-title":""}},[e._v(" Calcul des ingrédients ")]),r("v-card-text",[r("select-sejour",{attrs:{label:"Séjour"},model:{value:e.sejour,callback:function(t){e.sejour=t},expression:"sejour"}}),r("v-row",{staticClass:"mt-4 px-2",attrs:{"no-gutters":""}},[r("v-col",[e._v("Journées")])],1),r("v-row",{staticClass:"px-2",attrs:{"no-gutters":""}},[r("v-col",{staticClass:"align-self-center"},[r("v-switch",{attrs:{label:"Tout le séjour"},model:{value:e.all,callback:function(t){e.all=t},expression:"all"}})],1),r("v-col",[r("div",{staticClass:"overflow-y-auto px-3",style:{height:"40vh"}},e._l(e.choixJournees,(function(t){return r("v-checkbox",{key:t,attrs:{label:e.offsetToDate(t),value:t,"hide-details":"",disabled:e.all},model:{value:e.jourOffsets,callback:function(t){e.jourOffsets=t},expression:"jourOffsets"}})})),1)])],1),r("div")],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"secondary",disabled:!e.valid},on:{click:e.calcul}},[e._v(" Calculer les ingrédients ")])],1)],1)],1)},nt=[],at=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-select",{staticClass:"mx-2",attrs:{items:e.sejours,label:e.label,"hide-details":"","max-width":"200",value:e.idSejour},on:{change:function(t){return e.$emit("change",Number(t))}}})},it=[],ot=n["a"].extend({props:{label:String,idSejour:Number},model:{prop:"idSejour",event:"change"}}),st=function(e){function t(){return Object(o["a"])(this,t),Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"sejours",get:function(){var e=Object.values(m["a"].data.agenda.sejours).map((function(e){return{value:e.sejour.id,text:e.sejour.nom}}));return e.sort((function(e,t){return Number(e.text<t.text)})),e}}]),t}(ot);st=Object(d["a"])([Object(p["b"])({})],st);var ut=st,ct=ut,lt=Object(k["a"])(ct,at,it,!1,null,"1ff4ade6",null),dt=lt.exports;y()(lt,{VSelect:Be["a"]});var pt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-expansion-panels",{attrs:{value:0}},e._l(e.dateIngredients,(function(t,n){return r("v-expansion-panel",{key:n,attrs:{disabled:e.dateIngredients.length<=1}},[r("v-expansion-panel-header",{attrs:{"hide-actions":e.dateIngredients.length<=1}},[r("b",[e._v(e._s(e.formatDate(t.date)))])]),r("v-expansion-panel-content",[r("liste-ingredients",{attrs:{ingredients:t.ingredients}})],1)],1)})),1)},ft=[],vt=n["a"].extend({props:{dateIngredients:Array}}),ht=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.formatDate=se["a"].formatDate,e}return Object(l["a"])(t,e),t}(vt);ht=Object(d["a"])([Object(p["b"])({components:{ListeIngredients:Ae}})],ht);var mt=ht,gt=mt,bt=r("cd55"),jt=r("49e2"),kt=r("c865"),wt=r("0393"),yt=Object(k["a"])(gt,pt,ft,!1,null,"02b3f4b1",null),Ot=yt.exports;y()(yt,{VExpansionPanel:bt["a"],VExpansionPanelContent:jt["a"],VExpansionPanelHeader:kt["a"],VExpansionPanels:wt["a"]});var xt=n["a"].extend({props:{initialSejour:Number}}),_t=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.sejour=e.initialSejour,e.all=!0,e.jourOffsets=[],e.showPrevisuIngredients=!1,e.loadingIngredients=!1,e.dateIngredients=[],e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"onPropChange",value:function(){this.sejour=this.initialSejour}},{key:"offsetToDate",value:function(e){var t=m["a"].formatter.offsetToDate(this.sejour,e);return se["a"].formatDate(t.toISOString())}},{key:"calcul",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.showPrevisuIngredients=!0,this.loadingIngredients=!0,!this.all){e.next=8;break}return e.next=5,m["a"].calculs.resoudIngredientsSejour(this.sejour);case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,m["a"].calculs.resoudIngredientsJournees(this.sejour,this.jourOffsets);case 10:t=e.sent;case 11:if(this.loadingIngredients=!1,void 0!=t){e.next=15;break}return this.showPrevisuIngredients=!1,e.abrupt("return");case 15:this.dateIngredients=t.date_ingredients||[];case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"valid",get:function(){return this.all||this.jourOffsets.length>0}},{key:"choixJournees",get:function(){var e=Object.keys(m["a"].data.agenda.sejours[this.sejour].journees).map((function(e){return Number(e)}));return e.sort()}}]),t}(xt);Object(d["a"])([Object(f["a"])("initialSejour")],_t.prototype,"onPropChange",null),_t=Object(d["a"])([Object(p["b"])({components:{SelectSejour:dt,DateIngredients:Ot}})],_t);var St=_t,Rt=St,Ct=r("ac7c"),Et=Object(k["a"])(Rt,rt,nt,!1,null,"6226aa84",null),Dt=Et.exports;function Vt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function It(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(r),!0).forEach((function(t){Object(re["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}y()(Et,{VBtn:M["a"],VCard:O["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VCheckbox:Ct["a"],VCol:_["a"],VDialog:S["a"],VRow:R["a"],VSkeletonLoader:He["a"],VSpacer:ye["a"],VSwitch:Ge["a"]});var Tt=[0,1,2,3,4,5,6],Pt=["red","pink","purple","indigo","blue","cyan","teal","green","lime","yellow","amber","orange","brown","grey"];function Mt(e){var t=e.getDay();return Tt.map((function(e){return(t+e)%7}))}function At(e){return e.toISOString().substr(0,10)}function Lt(e){return{heure:Number(e.substr(0,2)),minute:Number(e.substr(3,2))}}function Nt(e){var t=m["a"].formatter.offsetToDate(e.id_sejour,e.jour_offset);return At(t)+" "+se["a"].horaireToTime(e.horaire)}var $t=n["a"].extend({props:{}}),Ft=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.lastClickedTime=null,e.currentSejour=null,e.preferences={restrictSejourCourant:!0,startPremierJour:!0},e.firstInterval=4,e.intervalMinutes=120,e.intervalCount=8,e.intervalHeight=25,e.showPreferences=!1,e.showEditFormSejour=!1,e.showEditFormRepas=!1,e.showConfirmeSupprime=!1,e.showFormCalcul=!1,e.editMode="new",e.editedRepas={id:-1,id_sejour:-1,horaire:{heure:0,minute:0},id_menu:-1,nb_personnes:0,jour_offset:0},e.getEventColor=function(t){return e.sejourColor(t.repas.id_sejour)},e.onDragStart=function(e,t,r){e.dataTransfer&&r&&(e.dataTransfer.setData(t,r),e.dataTransfer.effectAllowed="move")},e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"sejourColor",value:function(e){var t=Pt.length,r=this.sortedSejours.findIndex((function(t){return t.sejour.id==e}));return-1!=r?Pt[r%t]:"black"}},{key:"intervalStyle",value:function(e){var t=new Date(e.date),r=this.getCurrentSejour();if(!r)return{};var n=new Date(r.date_debut);return n<=t?{backgroundColor:this.sejourColor(r.id),opacity:.15}:void 0}},{key:"mounted",value:function(){this.setupDrag()}},{key:"updated",value:function(){this.setupDrag()}},{key:"setClosestSejour",value:function(){var e=Object.values(m["a"].data.agenda.sejours);if(0!=e.length){var t=(new Date).valueOf(),r=function(e){var r=t-new Date(e.date_debut).valueOf();return Math.abs(r)},n=e.map((function(e){return{id:e.sejour.id,distance:r(e.sejour)}})),a=n.sort((function(e,t){return e.distance<t.distance?1:-1}))[0];this.currentSejour=a.id}}},{key:"registerTime",value:function(e){this.lastClickedTime=e}},{key:"setupDrag",value:function(){var e=this;if(null!=this.currentSejour){var t=this.$refs.weeks;t.querySelectorAll("[data-day]").forEach((function(t){t.parentElement&&(t.parentElement.draggable=!0,t.parentElement.ondragstart=function(r){return e.onDragStart(r,"journee",t.dataset.day)},t.parentElement.ondragover=function(t){return e.onDragover(t,"journee")},t.parentElement.ondrop=function(t){return e.onDrop(t,"journee")})})),t.querySelectorAll("[data-repas]").forEach((function(t){var r=JSON.parse(t.dataset.repas||"");t.draggable=r.id_sejour==e.currentSejour,t.ondragstart=function(r){return e.onDragStart(r,"repas",t.dataset.repas)}}))}}},{key:"onDragover",value:function(e,t){if(e.dataTransfer){var r=e.dataTransfer.types.includes("repas"),n=e.dataTransfer.types.includes("journee");("repas"==t&&r||"journee"==t&&n)&&(e.preventDefault(),e.dataTransfer.dropEffect="move")}}},{key:"onDrop",value:function(e,t){if(e.dataTransfer){e.preventDefault();var r=e.dataTransfer.getData(t),n=e.currentTarget;"repas"==t?this.onDropRepas(e,r,n):this.onDropJournee(r,n)}}},{key:"jobDropRepas",value:function(e,t){var r=JSON.parse(t),n=new Date(e.date),a={heure:Number(e.time.substr(0,2)),minute:Number(e.time.substr(3,2))};m["a"].data.deplaceRepas(r,n,a)}},{key:"onDropRepas",value:function(e,t,r){var n=this,a=new MouseEvent("mousedown",{view:window,bubbles:!0,cancelable:!0,clientX:e.clientX,clientY:e.clientY});this.lastClickedTime=null,r.dispatchEvent(a);var i=0,o=function e(){if(!(i>=200))return n.lastClickedTime?void n.jobDropRepas(n.lastClickedTime,t):(i+=1,void setTimeout(e,50))};setTimeout(o,50)}},{key:"onDropJournee",value:function(e,t){if(null!=this.currentSejour){var r=t.querySelector("[data-day]"),n=new Date(e);if(r&&r.dataset.day){var a=new Date(r.dataset.day);isNaN(n.getTime())||isNaN(a.getTime())||m["a"].data.switchDays(this.currentSejour,n,a)}}}},{key:"getCurrentSejour",value:function(){if(null!=this.currentSejour)return m["a"].data.agenda.sejours[this.currentSejour].sejour}},{key:"getInitialCurrentSejour",value:function(){var e={id_proprietaire:m["a"].idUtilisateur,nom:"",date_debut:""};return this.getCurrentSejour()||e}},{key:"onEditSejourDone",value:function(e){this.showEditFormSejour=!1,"edit"==this.editMode?this.editSejour(e):this.addSejour(e)}},{key:"addSejour",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=m["a"].idUtilisateur){e.next=2;break}return e.abrupt("return");case 2:return r={nom:t.nom,date_debut:t.date_debut,id_proprietaire:m["a"].idUtilisateur},e.next=5,m["a"].data.createSejour(r);case 5:n=e.sent,null==m["a"].notifications.getError()&&void 0!=n&&(m["a"].notifications.setMessage("Le séjour a bien été ajouté."),this.currentSejour=n.id);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"editSejour",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this.getCurrentSejour(),void 0!=r){e.next=3;break}return e.abrupt("return");case 3:return r.date_debut=t.date_debut,r.nom=t.nom,e.next=7,m["a"].data.updateSejour(r);case 7:null==m["a"].notifications.getError()&&m["a"].notifications.setMessage("Le séjour a bien été modifié.");case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"supprimeSejour",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.getCurrentSejour(),null!=t){e.next=3;break}return e.abrupt("return");case 3:return this.currentSejour=null,this.showConfirmeSupprime=!1,e.next=7,m["a"].data.deleteSejour(t);case 7:null==m["a"].notifications.getError()&&m["a"].notifications.setMessage("Le séjour a été supprimé avec succès.");case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"startAddRepas",value:function(e){var t=this.getCurrentSejour();if(void 0!=t){var r=m["a"].data.getOffset(t,new Date(e.date));void 0!=r&&(this.editedRepas={horaire:Lt(e.time),jour_offset:r,nb_personnes:0,id_menu:-1,id_sejour:t.id,id:-1},this.editMode="new",this.showEditFormRepas=!0)}}},{key:"startEditRepas",value:function(e){this.editedRepas=e,this.editMode="edit",this.showEditFormRepas=!0}},{key:"onEditRepasDone",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.showEditFormRepas=!1,null!=this.currentSejour){e.next=3;break}return e.abrupt("return");case 3:if(r="","new"!=this.editMode){e.next=11;break}return n=It({},t,{id_sejour:this.currentSejour}),e.next=8,m["a"].data.createRepas(n);case 8:r="Le repas a bien été ajouté.",e.next=15;break;case 11:return a=It({},t,{id_sejour:this.editedRepas.id_sejour,id:this.editedRepas.id}),e.next=14,m["a"].data.updateManyRepas([a]);case 14:r="Le repas a bien été mis à jour.";case 15:null==m["a"].notifications.getError()&&m["a"].notifications.setMessage(r);case 16:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteRepas",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.showEditFormRepas=!1,e.next=3,m["a"].data.deleteRepas(t);case 3:null==m["a"].notifications.getError()&&m["a"].notifications.setMessage("Le repas a été retiré avec succès.");case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"startDate",get:function(){var e=this.getCurrentSejour();return e?new Date(e.date_debut):new Date}},{key:"weekdays",get:function(){return this.preferences.startPremierJour?Mt(this.startDate):[1,2,3,4,5,6,0]}},{key:"startWeek1",get:function(){return At(this.startDate)}},{key:"startWeek2",get:function(){var e=this.startDate;return e.setDate(this.startDate.getDate()+7),At(e)}},{key:"events",get:function(){var e=this,t=[],r=this.preferences.restrictSejourCourant;return m["a"].iterateAllRepas((function(n,a){if(!r||n.id==e.currentSejour){var i={repas:a,name:m["a"].formatter.formatRepasName(a),start:Nt(a),dataRepas:JSON.stringify(a)};t.push(i)}})),t}},{key:"sortedSejours",get:function(){var e=Object.values(m["a"].data.agenda.sejours);return e.sort((function(e,t){return e.sejour.date_debut<t.sejour.date_debut?1:-1})),e}}]),t}($t);Ft=Object(d["a"])([Object(p["b"])({components:{TooltipBtn:Re["a"],FormSejour:xe,FormRepas:ze,FormPreferences:tt,SelectSejour:dt,FormCalcul:Dt}})],Ft);var Jt=Ft,Ut=Jt,Bt=(r("f0f3"),r("a4f6")),Ht=r("ce7e"),qt=r("71d9"),zt=r("2a7f"),Wt=Object(k["a"])(Ut,ee,te,!1,null,null,null),Qt=Wt.exports;y()(Wt,{VBtn:M["a"],VCalendar:Bt["a"],VCard:O["a"],VCardActions:x["a"],VCardText:x["b"],VCardTitle:x["c"],VDialog:S["a"],VDivider:Ht["a"],VSpacer:ye["a"],VToolbar:qt["a"],VToolbarItems:zt["a"],VToolbarTitle:zt["b"]});var Yt=function(e){function t(){return Object(o["a"])(this,t),Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"mounted",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m["a"].data.loadAllMenus();case 2:return e.next=4,m["a"].data.loadAgenda();case 4:null==m["a"].notifications.getError()&&m["a"].notifications.setMessage("L'agenda a bien été chargé."),this.$refs.calendar.setClosestSejour();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(n["a"]);Yt=Object(d["a"])([Object(p["b"])({components:{Calendar:Qt}})],Yt);var Kt=Yt,Zt=Kt,Xt=r("a523"),Gt=Object(k["a"])(Zt,Z,X,!1,null,null,null),er=Gt.exports;y()(Gt,{VContainer:Xt["a"]}),n["a"].use(K["a"]);var tr=[{path:"/agenda",name:"agenda",component:er,meta:{title:"Agenda",tooltip:"Vue d'ensemble des séjours et des repas.",icon:"mdi-calendar-month"}},{path:"/menus",name:"menus",component:function(){return r.e("menus").then(r.bind(null,"37fd"))},meta:{title:"Menus, recettes et ingrédients",tooltip:"Accès aux menus, recettes et ingrédients.",icon:"mdi-food-variant"}}],rr=new K["a"]({mode:"history",routes:tr}),nr=rr,ar=n["a"].extend({props:{isLoggedIn:Boolean}}),ir=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.menuMini=!0,e.routes=tr,e}return Object(l["a"])(t,e),t}(ar);ir=Object(d["a"])([p["b"]],ir);var or=ir,sr=or,ur=r("8212"),cr=r("adda"),lr=r("a722"),dr=r("8860"),pr=r("da13"),fr=r("1800"),vr=r("5d23"),hr=r("f774"),mr=r("3a2f"),gr=Object(k["a"])(sr,Q,Y,!1,null,null,null),br=gr.exports;y()(gr,{VAvatar:ur["a"],VDivider:Ht["a"],VIcon:A["a"],VImg:cr["a"],VLayout:lr["a"],VList:dr["a"],VListItem:pr["a"],VListItemAction:fr["a"],VListItemContent:vr["a"],VNavigationDrawer:hr["a"],VTooltip:mr["a"]});var jr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"fill-height align-self-center",attrs:{fluid:""}},[r("v-row",[r("v-col",{attrs:{xs:"0",md:"2"}}),r("v-col",{attrs:{xs:"6",md:"4"}},[r("v-form",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loggin(t)}},model:{value:e.formValid,callback:function(t){e.formValid=t},expression:"formValid"}},[r("v-text-field",{attrs:{label:"Mail",rules:[e.rules.required,e.rules.mail],required:"",name:"email",autocomplete:"email"},model:{value:e.params.mail,callback:function(t){e.$set(e.params,"mail",t)},expression:"params.mail"}}),r("v-text-field",{attrs:{name:"password","append-icon":e.showPassword?"mdi-eye":"mdi-eye-off",type:e.showPassword?"password":"text",label:"Mot de passe",autocomplete:"password"},on:{"click:append":function(t){e.showPassword=!e.showPassword}},model:{value:e.params.password,callback:function(t){e.$set(e.params,"password",t)},expression:"params.password"}}),r("v-fade-transition",[e.error?r("v-row",[r("div",{staticClass:"red--text px-3",domProps:{innerHTML:e._s(e.error)}})]):e._e()],1),r("v-row",{staticClass:"mt-3"},[r("v-spacer"),r("v-btn",{attrs:{color:"success",loading:e.loading,disabled:!e.formValid},on:{click:e.loggin}},[e._v(" Se connecter ")])],1)],1)],1),r("v-col",{staticClass:"xs-6 md-4"},[e._v(" TODO : créer un compte ")]),r("v-col")],1)],1)},kr=[],wr=(r("c975"),/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),yr=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.params={mail:"",password:""},e.showPassword=!1,e.error=null,e.rules={required:function(e){return!!e||"Ce champ est requis."},mail:function(e){return wr.test(e)||"L'adresse mail semble invalide."}},e.loading=!1,e.formValid=!1,e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"mounted",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loggin",value:function(){var e=Object(G["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.formValid){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,e.next=5,m["a"].logger.loggin(this.params);case 5:if(t=e.sent,this.loading=!1,null==m["a"].notifications.getError()){e.next=9;break}return e.abrupt("return");case 9:""!=t&&t?this.error=t:(this.error=null,r=this.$router.currentRoute.path,-1==tr.map((function(e){return e.path})).indexOf(r)&&this.$router.push("/agenda"));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),t}(n["a"]);yr=Object(d["a"])([Object(p["b"])({})],yr);var Or=yr,xr=Or,_r=r("0789"),Sr=Object(k["a"])(xr,jr,kr,!1,null,null,null),Rr=Sr.exports;y()(Sr,{VBtn:M["a"],VCol:_["a"],VContainer:Xt["a"],VFadeTransition:_r["d"],VForm:we["a"],VRow:R["a"],VSpacer:ye["a"],VTextField:ve["a"]});var Cr=function(e){function t(){var e;return Object(o["a"])(this,t),e=Object(u["a"])(this,Object(c["a"])(t).apply(this,arguments)),e.controller=m["a"],e}return Object(l["a"])(t,e),Object(s["a"])(t,[{key:"logout",value:function(){this.controller.logger.logout()}},{key:"getPageTitle",value:function(){var e;if(this.isLoggedIn){var t=this.$route;e="Intendance - "+t.meta.title}else e="Intendance - Connexion";return e}},{key:"updatePageTitle",value:function(){document.title=this.getPageTitle()}},{key:"onRouteChanged",value:function(){this.updatePageTitle()}},{key:"mounted",value:function(){this.updatePageTitle()}},{key:"version",get:function(){return"0.2.0"}},{key:"isLoggedIn",get:function(){return this.controller.isLoggedIn}},{key:"mainTitle",get:function(){return this.isLoggedIn?this.getPageTitle():"Bienvenue sur votre platforme d'intendance"}}]),t}(n["a"]);Object(d["a"])([Object(f["a"])("$route")],Cr.prototype,"onRouteChanged",null),Cr=Object(d["a"])([Object(p["b"])({components:{ErrorDialog:E,SuccessSnackbar:$,SpinnerSnackbar:W,NavigationBar:br,Loggin:Rr}})],Cr);var Er=Cr,Dr=Er,Vr=r("7496"),Ir=r("40dc"),Tr=r("a75b"),Pr=Object(k["a"])(Dr,a,i,!1,null,null,null),Mr=Pr.exports;y()(Pr,{VApp:Vr["a"],VAppBar:Ir["a"],VContent:Tr["a"],VToolbarTitle:zt["b"],VTooltip:mr["a"]});var Ar=r("f309");n["a"].use(Ar["a"]);var Lr=new Ar["a"]({theme:{themes:{light:{primary:"#e0a912",secondary:"#a5d0d9"}}}});n["a"].config.productionTip=!1;var Nr="The .native modifier for v-on is only valid on components but it was used on <div>.";n["a"].config.warnHandler=function(e,t,r){e!==Nr&&console.error("[Vue warn]: "+e+r)},new n["a"]({router:nr,vuetify:Lr,render:function(e){return e(Mr)}}).$mount("#app")},cf05:function(e,t,r){e.exports=r.p+"img/logo.f3875c84.png"},f0f3:function(e,t,r){"use strict";var n=r("0685"),a=r.n(n);a.a}});
//# sourceMappingURL=app.8b94661b.js.map