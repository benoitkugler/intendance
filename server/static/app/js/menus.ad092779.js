(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["menus"],{1681:function(e,t,n){},"37fd":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",{staticClass:"py-1 px-2",attrs:{fluid:""}},[n("v-row",{attrs:{wrap:""}},["visu"==e.state.mode||"editMenu"==e.state.mode?n("v-col",{attrs:{md:"4",sm:"6"}},[n("transition-group",{attrs:{name:"fade",mode:"out-in",duration:"200"}},[n("liste-menus",{directives:[{name:"show",rawName:"v-show",value:"visu"==e.state.mode,expression:"state.mode == 'visu'"}],key:"liste",ref:"listeMenus",attrs:{height:"75vh",state:e.state},on:{change:function(t){return e.state.selection.idMenu=t},edit:e.startEditMenu,new:e.startCreateMenu}}),n("edit-menu",{directives:[{name:"show",rawName:"v-show",value:"editMenu"==e.state.mode,expression:"state.mode == 'editMenu'"}],key:"edit",attrs:{mode:e.editMode,initialMenu:e.editedMenu},on:{undo:e.editMenuCancel,done:e.editMenuDone}})],1)],1):e._e(),n("v-col",[n("liste-recettes",{directives:[{name:"show",rawName:"v-show",value:"visu"==e.state.mode||"editMenu"==e.state.mode,expression:"state.mode == 'visu' || state.mode == 'editMenu'"}],key:"liste",ref:"listeRecettes",attrs:{height:"75vh",state:e.state},on:{change:function(t){return e.state.selection.idRecette=t},edit:e.startEditRecette,new:e.startCreateRecette}}),n("edit-recette",{directives:[{name:"show",rawName:"v-show",value:"editRecette"==e.state.mode,expression:"state.mode == 'editRecette'"}],key:"edit",attrs:{mode:e.editMode,initialRecette:e.editedRecette},on:{undo:e.editRecetteCancel,done:e.editRecetteDone}})],1),n("v-col",{attrs:{md:"4",sm:"12"}},[n("liste-ingredients",{ref:"listeIngredients",attrs:{height:"75vh",state:e.state},on:{change:function(t){return e.state.selection.idIngredient=t}}})],1)],1)],1)},r=[],a=(n("a9e3"),n("5530")),o=(n("96cf"),n("1da1")),s=n("d4ec"),c=n("bee2"),u=n("99de"),d=n("7e84"),l=n("262e"),m=n("9ab4"),p=n("2fe1"),v=n("2b0e"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.confirmeSupprime,callback:function(t){e.confirmeSupprime=t},expression:"confirmeSupprime"}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":"",color:"warning"}},[e._v(" Confirmer la suppression ")]),n("v-card-text",[e._v(" Confirmez-vous la suppression de ce menu ? ")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{tile:"",color:"warning"},on:{click:e.supprime}},[e._v("Supprimer")])],1)],1)],1),n("toolbar",{attrs:{tooltipAdd:"Ajouter un menu...",title:"Menus",showAdd:"visu"==e.state.mode},on:{add:function(t){return e.$emit("new")}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),n("v-list",{ref:"list",staticClass:"overflow-y-auto",attrs:{dense:"","max-height":e.height}},[n("v-list-item-group",{attrs:{value:e.state.selection.idMenu},on:{change:function(t){return e.$emit("change",t)}}},e._l(e.menus,(function(t){return n("v-list-item",{key:t.id,class:e.classItem(t.id),attrs:{value:t.id},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.active;return[n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(e.formatMenuName(t)))]),n("v-list-item-subtitle",[n("i",[e._v(" "+e._s(e.formatMenuProprietaire(t)))])])],1),e.showButtons(r,t)?n("v-list-item-action",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"pencil",tooltip:"Modifier ce menu",color:"secondary"},on:{click:function(n){return n.stopPropagation(),e.$emit("edit",t)}}})],1),n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"close",tooltip:"Supprimer ce menu",color:"red"},on:{click:function(t){t.stopPropagation(),e.confirmeSupprime=!0}}})],1)],1)],1):e._e()]}}],null,!0)})})),1)],1)],1)},h=[],g=(n("ac1f"),n("841c"),n("1c9b")),b=n("fa46"),k=n("0f2e"),y=v["a"].extend({props:{height:String,state:Object,kind:String}}),I=function(e){function t(){return Object(s["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"classItem",value:function(e){return this.kind+e}},{key:"goToItem",value:function(e){this.state.selection[this.kind]=e;try{this.$vuetify.goTo("."+this.classItem(e),{container:this.$refs.list})}catch(t){}}}]),t}(y);I=Object(m["a"])([Object(p["b"])({})],I);var w=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.confirmeSupprime=!1,e.formatMenuName=k["a"].formatter.formatMenuName,e.formatMenuProprietaire=k["a"].formatter.formatMenuOrRecetteProprietaire,e.search="",e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"showButtons",value:function(e,t){return e&&(!t.id_proprietaire.Valid||t.id_proprietaire.Int64==k["a"].idUtilisateur)}},{key:"supprime",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.confirmeSupprime=!1,null!=this.state.selection.idMenu){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,k["a"].data.deleteMenu(this.state.selection.idMenu);case 5:null==k["a"].notifications.getError()&&k["a"].notifications.setMessage("Menu supprimé avec succès.");case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"menus",get:function(){return k["a"].searchMenu(this.search)}}]),t}(I);w=Object(m["a"])([Object(p["b"])({components:{TooltipBtn:g["a"],Toolbar:b["a"]},props:{kind:{type:String,default:"idMenu"}}})],w);var _=w,j=_,x=n("2877"),O=n("6544"),V=n.n(O),C=n("8336"),R=n("b0af"),M=n("99d9"),P=n("62ad"),T=n("169a"),S=n("8860"),E=n("da13"),$=n("1800"),D=n("5d23"),L=n("1baa"),q=n("0fd9"),A=n("2fa4"),F=Object(x["a"])(j,f,h,!1,null,null,null),N=F.exports;V()(F,{VBtn:C["a"],VCard:R["a"],VCardActions:M["a"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VDialog:T["a"],VList:S["a"],VListItem:E["a"],VListItemAction:$["a"],VListItemContent:D["a"],VListItemGroup:L["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:q["a"],VSpacer:A["a"]});var B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.confirmeSupprime,callback:function(t){e.confirmeSupprime=t},expression:"confirmeSupprime"}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":"",color:"warning"}},[e._v(" Confirmer la suppression ")]),n("v-card-text",[e._v(" Confirmez-vous la suppression de cette recette ? "),n("br"),n("div",{staticClass:"my-3"},[n("small",[e._v(" Si vous souhaitez seulement l'enlever d'un menu, passez plutôt en "),n("b",[e._v("mode édition")]),e._v(". ")])])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{tile:"",color:"warning"},on:{click:e.supprime}},[e._v("Supprimer")])],1)],1)],1),n("toolbar",{attrs:{tooltipAdd:"Ajouter une recette...",title:e.title,showAdd:"visu"==e.state.mode&&null==e.state.selection.idMenu},on:{add:function(t){return e.$emit("new")}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),n("v-list",{ref:"list",staticClass:"overflow-y-auto",attrs:{dense:"","max-height":e.height}},[n("v-list-item-group",{attrs:{value:e.state.selection.idRecette},on:{change:function(t){return e.$emit("change",t)}}},e._l(e.recettes,(function(t){return n("v-list-item",{key:t.id,class:e.classItem(t.id),attrs:{value:t.id},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.active;return[n("v-list-item-content",{attrs:{draggable:"true"},on:{dragstart:function(n){return e.onDragStart(n,t)}}},[n("v-list-item-title",[n("v-list-item-title",[e._v(e._s(t.nom))])],1),n("v-list-item-subtitle",[n("i",[e._v(" "+e._s(e.formatRecetteProprietaire(t)))])])],1),e.showActions(r,t)?n("v-list-item-action",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"pencil",tooltip:"Modifier cette recette",color:"secondary"},on:{click:function(n){return n.stopPropagation(),e.$emit("edit",t)}}})],1),n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"close",tooltip:"Supprimer cette recette",color:"red"},on:{click:function(t){t.stopPropagation(),e.confirmeSupprime=!0}}})],1)],1)],1):e._e()]}}],null,!0)})})),1)],1)],1)},z=[],U=(n("4de4"),n("07ac"),n("fe36")),H=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.confirmeSupprime=!1,e.search="",e.formatRecetteProprietaire=k["a"].formatter.formatMenuOrRecetteProprietaire,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"searchRecettes",value:function(e,t){var n=Object(U["d"])(t);return e.filter((function(e){return n(e.nom)}))}},{key:"showActions",value:function(e,t){return null==this.state.selection.idMenu&&(e&&(!t.id_proprietaire.Valid||t.id_proprietaire.Int64==k["a"].idUtilisateur))}},{key:"supprime",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.confirmeSupprime=!1,null!=this.state.selection.idRecette){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,k["a"].data.deleteRecette(this.state.selection.idRecette);case 5:this.$emit("change",null),null==k["a"].notifications.getError()&&k["a"].notifications.setMessage("Recette supprimée avec succès.");case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onDragStart",value:function(e,t){e.dataTransfer&&(e.dataTransfer.setData("id-recette",String(t.id)),e.dataTransfer.effectAllowed="copy")}},{key:"recettes",get:function(){var e;return e="editMenu"==this.state.mode?Object.values(k["a"].data.recettes):null!=this.state.selection.idMenu?k["a"].getMenuRecettes(k["a"].getMenu(this.state.selection.idMenu)):Object.values(k["a"].data.recettes),this.searchRecettes(e,this.search)}},{key:"title",get:function(){return"editMenu"==this.state.mode?"Choisir une recette":null!=this.state.selection.idMenu?"Recettes liées au menu":"Toutes les recettes"}}]),t}(I);H=Object(m["a"])([Object(p["b"])({components:{TooltipBtn:g["a"],Toolbar:b["a"]},props:{kind:{type:String,default:"idRecette"}}})],H);var G=H,Q=G,J=Object(x["a"])(Q,B,z,!1,null,null,null),K=J.exports;V()(J,{VBtn:C["a"],VCard:R["a"],VCardActions:M["a"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VDialog:T["a"],VList:S["a"],VListItem:E["a"],VListItemAction:$["a"],VListItemContent:D["a"],VListItemGroup:L["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:q["a"],VSpacer:A["a"]});var W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"800px"},model:{value:e.showEditIngredient,callback:function(t){e.showEditIngredient=t},expression:"showEditIngredient"}},[n("edit-ingredient",{attrs:{initialIngredient:e.editedIngredient,mode:e.editMode},on:{edit:e.editIngredientDone}})],1),n("v-dialog",{attrs:{scrollable:"",width:"90%"},model:{value:e.showEditProduits,callback:function(t){e.showEditProduits=t},expression:"showEditProduits"}},[n("association-ingredient",{attrs:{ingredient:e.editedIngredientProduit,activated:e.showEditProduits}})],1),n("v-dialog",{attrs:{"max-width":"800px"},model:{value:e.confirmeSupprime,callback:function(t){e.confirmeSupprime=t},expression:"confirmeSupprime"}},[n("v-card",[n("v-card-title",{attrs:{"primary-title":"",color:"warning"}},[e._v(" Confirmer la suppression ")]),n("v-card-text",[e._v(" Vous avez demandé la suppression de cet ingrédient. "),n("br"),e._v(" Souhaitez-vous vérifiez qu'aucun produit n'y est associé ? Dans le cas contraire, les éventuelles associations ingrédient/produit seront supprimées. "),n("div",{staticClass:"my-3"},[n("small",[e._v(" Si vous souhaitez seulement enlever l'ingrédient d'un menu ou d'une recette, passez plutôt en "),n("b",[e._v("mode édition")]),e._v(". ")])])]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{tile:"",color:"warning"},on:{click:function(t){return e.supprime(!1)}}},[e._v(" Supprimer l'ingrédient et les liens produits ")]),n("v-btn",{attrs:{tile:"",color:"warning"},on:{click:function(t){return e.supprime(!0)}}},[e._v(" Vérifier les liens avant de supprimer ")])],1)],1)],1),n("toolbar",{attrs:{tooltipAdd:"Ajouter un ingrédient...",title:e.title,showAdd:"visu"==e.state.mode&&null==e.state.selection.idMenu&&null==e.state.selection.idRecette},on:{add:e.startCreateIngredient},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),n("v-list",{ref:"list",staticClass:"overflow-y-auto",attrs:{dense:"","max-height":e.height}},[n("v-list-item-group",{attrs:{value:e.state.selection.idIngredient},on:{change:function(t){return e.$emit("change",t)}}},e._l(e.ingredients,(function(t){return n("v-list-item",{key:t.ingredient.id,class:e.classItem(t.ingredient.id),attrs:{value:t.ingredient.id},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.active;return[n("v-list-item-content",{attrs:{draggable:"true"},on:{dragstart:function(n){return e.onDragStart(n,t.ingredient)}}},[n("v-list-item-title",[e._v(" "+e._s(t.ingredient.nom)+" ")]),n("v-list-item-subtitle",{domProps:{innerHTML:e._s(e.subtitle(t))}})],1),e.showActions(r)?n("v-list-item-action",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"cart",tooltip:"Produits liés à cet ingrédient...",color:"accent"},on:{click:function(n){return n.stopPropagation(),e.startEditProduits(t)}}})],1),n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"pencil",tooltip:"Modifier cet ingrédient...",color:"secondary"},on:{click:function(n){return n.stopPropagation(),e.startEditIngredient(t)}}})],1),n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"close",tooltip:"Supprimer cet ingrédient",color:"red"},on:{click:function(t){t.stopPropagation(),e.confirmeSupprime=!0}}})],1)],1)],1):e._e()]}}],null,!0)})})),1)],1)],1)},X=[],Y=(n("99af"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("edit",e.current)}}},[n("v-card-title",{attrs:{"primary-title":""}},[e._v(" Détails de l'ingrédient ")]),n("v-card-text",[n("v-form",[n("v-row",[n("v-col",[n("v-text-field",{ref:"nom",attrs:{label:"Nom"},model:{value:e.current.nom,callback:function(t){e.$set(e.current,"nom",t)},expression:"current.nom"}})],1),n("v-col",[n("unite-field",{model:{value:e.current.unite,callback:function(t){e.$set(e.current,"unite",t)},expression:"current.unite"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"4"}},[n("v-switch",{attrs:{label:"Conditionnement requis"},model:{value:e.conditionnement,callback:function(t){e.conditionnement=t},expression:"conditionnement"}})],1),n("v-col",{attrs:{cols:"8"}},[n("conditionnement-field",{attrs:{disabled:!e.conditionnement,allowedUnites:e.allowedUnitesConditionnement},model:{value:e.current.conditionnement,callback:function(t){e.$set(e.current,"conditionnement",t)},expression:"current.conditionnement"}})],1)],1),n("v-row",[n("v-col",[n("v-select",{attrs:{items:[],label:"Catégorie"},model:{value:e.current.categorie,callback:function(t){e.$set(e.current,"categorie",t)},expression:"current.categorie"}})],1),n("v-col",[n("v-text-field",{attrs:{label:"Callories",required:""},model:{value:e.current.callories,callback:function(t){e.$set(e.current,"callories",t)},expression:"current.callories"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("edit",e.current)}}},[e._v(e._s(e.btnTitle))])],1)],1)}),Z=[],ee=n("60a3"),te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-select",{attrs:{disabled:e.disabled,items:e.unites,value:e.unite,label:e.label},on:{change:function(t){return e.$emit("change",t)}}})},ne=[],ie=n("5afb"),re=v["a"].extend({props:{unite:String,label:{type:String,default:"Unité"},disabled:{type:Boolean,default:!1},unites:{type:Array,default:function(){return ie["c"]}}},model:{prop:"unite",event:"change"}}),ae=function(e){function t(){return Object(s["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),t}(re);ae=Object(m["a"])([Object(p["b"])({})],ae);var oe=ae,se=oe,ce=n("b974"),ue=Object(x["a"])(se,te,ne,!1,null,"49ddb001",null),de=ue.exports;V()(ue,{VSelect:ce["a"]});var le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("v-text-field",{attrs:{disabled:e.disabled,label:"Conditionnement - Quantité",type:"number"},on:{change:e.onChange},model:{value:e.conditionnement.quantite,callback:function(t){e.$set(e.conditionnement,"quantite",e._n(t))},expression:"conditionnement.quantite"}})],1),n("v-col",{staticClass:"ml-3"},[n("unite-field",{attrs:{disabled:e.disabled,label:"Conditionnement - Unité",unites:e.allowedUnites},on:{change:e.onChange},model:{value:e.conditionnement.unite,callback:function(t){e.$set(e.conditionnement,"unite",t)},expression:"conditionnement.unite"}})],1)],1)},me=[],pe=v["a"].extend({props:{conditionnement:Object,disabled:Boolean,allowedUnites:Array},model:{prop:"conditionnement",event:"change"}}),ve=function(e){function t(){return Object(s["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"onChange",value:function(){this.$emit("change",this.conditionnement)}}]),t}(pe);ve=Object(m["a"])([Object(p["b"])({components:{UniteField:de}})],ve);var fe=ve,he=fe,ge=n("8654"),be=Object(x["a"])(he,le,me,!1,null,"3c3c95ca",null),ke=be.exports;V()(be,{VCol:P["a"],VRow:q["a"],VTextField:ge["a"]});var ye=n("5dc2"),Ie={nom:"",unite:"",categorie:"",conditionnement:{unite:"",quantite:0},callories:{}},we={id_proprietaire:{Valid:!0,Int64:-1},ingredients:[],mode_emploi:"",nom:""},_e={commentaire:"",id_proprietaire:{Valid:!0,Int64:-1},ingredients:[],recettes:[]},je=v["a"].extend({props:{initialIngredient:Object,mode:String}}),xe=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.current=e.copy(e.initialIngredient),e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"copy",value:function(e){var t=null==e?Object(a["a"])({},Ie,{id:-1}):e.ingredient;return Object(ye["b"])(t)}},{key:"onPropChange",value:function(){this.current=this.copy(this.initialIngredient)}},{key:"focus",value:function(){var e=this.$refs.nom.$el.querySelector("input");null!=e&&e.select()}},{key:"btnTitle",get:function(){return"edit"==this.mode?"Valider":"Créer"}},{key:"conditionnement",get:function(){return""!=this.current.conditionnement.unite},set:function(e){e?this.current.conditionnement.unite=this.current.unite||this.initialIngredient&&this.initialIngredient.ingredient.unite||"L":this.current.conditionnement={unite:"",quantite:0}}},{key:"allowedUnitesConditionnement",get:function(){var e=this;return this.current.unite==ie["b"].Piece?ie["c"].filter((function(e){return e.value!=ie["b"].Piece})):ie["c"].filter((function(t){return t.value==e.current.unite}))}}]),t}(je);Object(m["a"])([Object(ee["a"])("initialIngredient")],xe.prototype,"onPropChange",null),xe=Object(m["a"])([Object(p["b"])({components:{UniteField:de,ConditionnementField:ke}})],xe);var Oe=xe,Ve=Oe,Ce=n("4bd4"),Re=n("b73d"),Me=Object(x["a"])(Ve,Y,Z,!1,null,"d280dfd4",null),Pe=Me.exports;V()(Me,{VBtn:C["a"],VCard:R["a"],VCardActions:M["a"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VForm:Ce["a"],VRow:q["a"],VSelect:ce["a"],VSpacer:A["a"],VSwitch:Re["a"],VTextField:ge["a"]});var Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return null!=e.ingredient?n("v-card",[n("v-card-title",{attrs:{"primary-title":""}},[e._v(" Produits associés à l'ingrédient "+e._s(e.ingredient.nom)+" ")]),n("v-card-subtitle",[e._v(" Vous pouvez choisir ici quels produits concrets sont associés à l'ingrédient générique. ")]),n("v-card-text",[n("v-row",[n("v-col",[n("v-skeleton-loader",{staticClass:"h-100",attrs:{type:"paragraph",loading:e.loading}},[n("v-simple-table",{attrs:{dense:"","fixed-header":""}},[n("thead",[n("tr",[n("th",{staticClass:"text-left"},[e._v("Fournisseur")]),n("th",{staticClass:"text-left"},[e._v("Nom")]),n("th",{staticClass:"text-center"},[e._v("Prix")]),n("th",{staticClass:"text-center"},[e._v("Conditionnement")]),n("th")])]),n("tbody",e._l(e.produits,(function(t){return n("tr",{key:t.id},[n("td",[e._v(e._s(e.formatFournisseur(t)))]),n("td",[e._v(e._s(t.nom))]),n("td",{staticClass:"text-center"},[e._v(e._s(t.prix)+" €")]),n("td",{staticClass:"text-center"},[e._v(" "+e._s(e.formatConditionnement(t.conditionnement))+" ")]),n("td",[n("tooltip-btn",{attrs:{small:"","mdi-icon":"close",color:"red",tooltip:"Supprimer ce produit"},on:{click:function(n){return e.deleteProduit(t)}}})],1)])})),0)])],1)],1),n("v-col",[n("details-produit",{attrs:{produit:e.newProduit},on:{add:e.addProduit}})],1)],1)],1)],1):e._e()},Se=[],Ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-title",[e._v("Détails du produit")]),n("v-card-text",[n("v-form",{ref:"form"},[n("v-row",[n("v-col",[n("v-select",{attrs:{items:e.optionsFournisseurs,label:"Fournisseur",rules:[e.rules.idRequired]},model:{value:e.innerProduit.id_fournisseur,callback:function(t){e.$set(e.innerProduit,"id_fournisseur",t)},expression:"innerProduit.id_fournisseur"}})],1),n("v-col",[n("v-text-field",{attrs:{label:"Nom",rules:[e.rules.required]},model:{value:e.innerProduit.nom,callback:function(t){e.$set(e.innerProduit,"nom",t)},expression:"innerProduit.nom"}})],1)],1),n("v-row",[n("v-col",[n("v-text-field",{attrs:{label:"Prix",type:"number",suffix:"€",rules:[e.rules.required]},model:{value:e.innerProduit.prix,callback:function(t){e.$set(e.innerProduit,"prix",e._n(t))},expression:"innerProduit.prix"}})],1),n("v-col",[n("v-text-field",{attrs:{label:"Référence fournisseur"},model:{value:e.innerProduit.reference_fournisseur,callback:function(t){e.$set(e.innerProduit,"reference_fournisseur",t)},expression:"innerProduit.reference_fournisseur"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"8"}},[n("conditionnement-field",{model:{value:e.innerProduit.conditionnement,callback:function(t){e.$set(e.innerProduit,"conditionnement",t)},expression:"innerProduit.conditionnement"}})],1),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{label:"Colisage",type:"number"},model:{value:e.innerProduit.colisage,callback:function(t){e.$set(e.innerProduit,"colisage",e._n(t))},expression:"innerProduit.colisage"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"success"},on:{click:e.validate}},[e._v("Ajouter ce produit")])],1)],1)},$e=[],De=(n("d81d"),v["a"].extend({props:{produit:Object}})),Le=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.innerProduit=e.duplique(),e.rules={required:function(e){return!!e||"Champ requis"},idRequired:function(e){return e>=0||"Champ requis"}},e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"onChange",value:function(){this.innerProduit=this.duplique()}},{key:"duplique",value:function(){return Object(ye["b"])(this.produit)}},{key:"validate",value:function(){this.$refs.form.validate()&&this.$emit("add",this.innerProduit)}},{key:"optionsFournisseurs",get:function(){if(null==k["a"].data)return[];var e=Object.values(k["a"].data.fournisseurs||{}).map((function(e){return{text:e.nom,value:e.id}}));return Object(U["e"])(e)}}]),t}(De);Object(m["a"])([Object(ee["a"])("produit")],Le.prototype,"onChange",null),Le=Object(m["a"])([Object(p["b"])({components:{ConditionnementField:ke}})],Le);var qe=Le,Ae=qe,Fe=Object(x["a"])(Ae,Ee,$e,!1,null,"415da470",null),Ne=Fe.exports;V()(Fe,{VBtn:C["a"],VCard:R["a"],VCardActions:M["a"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VForm:Ce["a"],VRow:q["a"],VSelect:ce["a"],VSpacer:A["a"],VTextField:ge["a"]});var Be=n("ad05"),ze=v["a"].extend({props:{ingredient:Object,activated:Boolean}}),Ue=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.formatConditionnement=Be["a"].formatConditionnement,e.ingredientProduits=null,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"formatFournisseur",value:function(e){var t=k["a"].getFournisseur(e);return t.nom}},{key:"loadProduits",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.ingredient){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,k["a"].data.getIngredientProduits(this.ingredient.id);case 4:if(t=e.sent,void 0!=t){e.next=7;break}return e.abrupt("return");case 7:this.ingredientProduits=t;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"mounted",value:function(){this.loadProduits()}},{key:"onChangeIngredient",value:function(e){e&&this.loadProduits()}},{key:"addProduit",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.ingredient){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,k["a"].data.ajouteIngredientProduit({produit:t,id_ingredient:this.ingredient.id});case 4:n=e.sent,n&&(this.ingredientProduits=n,k["a"].notifications.setMessage("Produit créé et lié à ".concat(this.ingredient.nom)));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteProduit",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=this.ingredient){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,k["a"].data.deleteProduit(t.id);case 4:if(null==k["a"].notifications.getError()){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.loadProduits();case 8:if(null==k["a"].notifications.getError()){e.next=10;break}return e.abrupt("return");case 10:k["a"].notifications.setMessage("Produit ".concat(t.nom," supprimé avec succès"));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"newProduit",get:function(){var e={quantite:0,unite:""};return null!=this.ingredient&&(e=this.ingredient.conditionnement,this.ingredient.unite!=ie["b"].Piece&&(e.unite=this.ingredient.unite)),{id_fournisseur:-1,nom:"",conditionnement:e,prix:0,reference_fournisseur:"",colisage:0}}},{key:"loading",get:function(){return k["a"].notifications.getSpin()}},{key:"produits",get:function(){return null!=this.ingredientProduits&&this.ingredientProduits.produits||[]}}]),t}(ze);Object(m["a"])([Object(ee["a"])("activated")],Ue.prototype,"onChangeIngredient",null),Ue=Object(m["a"])([Object(p["b"])({components:{DetailsProduit:Ne,TooltipBtn:g["a"]}})],Ue);var He=Ue,Ge=He,Qe=n("1f4f"),Je=n("3129"),Ke=Object(x["a"])(Ge,Te,Se,!1,null,"0a14d9a9",null),We=Ke.exports;V()(Ke,{VCard:R["a"],VCardSubtitle:M["b"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VRow:q["a"],VSimpleTable:Qe["a"],VSkeletonLoader:Je["a"]});var Xe=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.confirmeSupprime=!1,e.showEditIngredient=!1,e.editMode="new",e.editedIngredient={ingredient:Object(a["a"])({},Ie,{id:-1})},e.showEditProduits=!1,e.search="",e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"subtitle",value:function(e){return e.options?"".concat(e.options.quantite," <i>").concat(e.ingredient.unite,"</i> - Cuisson : ").concat(e.options.cuisson||"-"):"<i>".concat(e.ingredient.unite,"</i>")}},{key:"searchIngredients",value:function(e,t){var n=Object(U["d"])(t);return e.filter((function(e){return t==e.ingredient.unite||n(e.ingredient.nom)})).sort((function(e,t){return Number(e.ingredient.nom<t.ingredient.nom)}))}},{key:"showActions",value:function(e){return null==this.state.selection.idMenu&&null==this.state.selection.idRecette&&e}},{key:"supprime",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.confirmeSupprime=!1,null!=this.state.selection.idIngredient){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,k["a"].data.deleteIngredient(this.state.selection.idIngredient,t);case 5:null==k["a"].notifications.getError()&&k["a"].notifications.setMessage("Ingrédient supprimé avec succès.");case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onDragStart",value:function(e,t){e.dataTransfer&&(e.dataTransfer.setData("id-ingredient",String(t.id)),e.dataTransfer.effectAllowed="copy")}},{key:"startEditIngredient",value:function(e){this.$emit("change",e),this.editedIngredient=e,this.editMode="edit",this.showEditIngredient=!0}},{key:"editIngredientDone",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.showEditIngredient=!1,n="","edit"!=this.editMode){e.next=9;break}return e.next=5,k["a"].data.updateIngredient(t);case 5:t=e.sent,n="L'ingrédient a été modifié avec succès.",e.next=13;break;case 9:return e.next=11,k["a"].data.createIngredient(t);case 11:t=e.sent,n="L'ingrédient a été ajouté avec succès.";case 13:null==k["a"].notifications.getError()&&(k["a"].notifications.setMessage(n),this.state.selection.idIngredient=t.id),this.$emit("change",null);case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"startCreateIngredient",value:function(){this.$emit("change",{ingredient:Ie}),this.editMode="new",this.showEditIngredient=!0}},{key:"startEditProduits",value:function(e){this.showEditProduits=!0}},{key:"title",get:function(){return"editMenu"==this.state.mode||"editRecette"==this.state.mode?"Choisir un ingrédient":null!=this.state.selection.idRecette?"Ingrédients liés à la recette":null!=this.state.selection.idMenu?"Ingrédients liés au menu":"Tous les ingrédients"}},{key:"editedIngredientProduit",get:function(){return null==this.state.selection.idIngredient?null:k["a"].getIngredient(this.state.selection.idIngredient)}},{key:"ingredients",get:function(){var e;return e="editMenu"==this.state.mode||"editRecette"==this.state.mode?k["a"].getAllIngredients():null!=this.state.selection.idRecette?k["a"].getRecetteIngredients(this.state.selection.idRecette):null!=this.state.selection.idMenu?k["a"].getMenuIngredients(this.state.selection.idMenu):k["a"].getAllIngredients(),this.searchIngredients(e,this.search)}}]),t}(I);Xe=Object(m["a"])([Object(p["b"])({components:{TooltipBtn:g["a"],EditIngredient:Pe,AssociationIngredient:We,Toolbar:b["a"]},props:{kind:{type:String,default:"idIngredient"}}})],Xe);var Ye=Xe,Ze=Ye,et=Object(x["a"])(Ze,W,X,!1,null,null,null),tt=et.exports;V()(et,{VBtn:C["a"],VCard:R["a"],VCardActions:M["a"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VDialog:T["a"],VList:S["a"],VListItem:E["a"],VListItemAction:$["a"],VListItemContent:D["a"],VListItemGroup:L["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:q["a"],VSpacer:A["a"]});var nt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.showEditIngredient,callback:function(t){e.showEditIngredient=t},expression:"showEditIngredient"}},[n("menu-or-recette-ingredient",{ref:"editIngredient",attrs:{ingredient:e.editedIngredient},on:{edit:e.editIngredientDone}})],1),n("v-toolbar",{staticClass:"my-1",attrs:{color:"secondary",dense:""}},[n("v-toolbar-title",[e._v(e._s(e.title))]),n("v-spacer"),n("v-toolbar-items",[n("tooltip-btn",{attrs:{"mdi-icon":"check-outline",tooltip:"Valider",color:"success"},on:{click:function(t){return e.$emit("done",e.menu)}}}),n("tooltip-btn",{attrs:{"mdi-icon":"undo",tooltip:"Abandonner les modifications"},on:{click:function(t){return e.$emit("undo")}}})],1)],1),n("v-textarea",{staticClass:"pa-2 mt-4 my-3 mb-0",attrs:{label:"Commentaire","hide-details":"",rows:"2"},model:{value:e.menu.commentaire,callback:function(t){e.$set(e.menu,"commentaire",t)},expression:"menu.commentaire"}}),n("v-list",{staticClass:"mt-0 pt-0 overflow-y-auto",attrs:{dense:"","max-height":"60vh"}},[n("div",{on:{dragover:e.onDragoverRecettes,drop:e.onDropRecette}},[n("v-subheader",[e._v("Recettes du menu")]),0==e.recettes.length?n("v-list-item",[n("v-list-item-subtitle",[n("i",[e._v("Cliquer-déplacer pour ajouter une recette...")])])],1):e._e(),e._l(e.recettes,(function(t){return n("v-list-item",{key:t.id,scopedSlots:e._u([{key:"default",fn:function(i){return[n("v-list-item-content",[n("v-list-item-title",[n("v-list-item-title",[e._v(e._s(t.nom))])],1),n("v-list-item-subtitle",[n("i",[e._v(" "+e._s(e.formatRecetteProprietaire(t)))])])],1),n("v-list-item-action",[n("tooltip-btn",{attrs:{"mdi-icon":"close",tooltip:"Retirer cette recette du menu",color:"red"},on:{click:function(n){return n.stopPropagation(),e.removeRecette(t)}}})],1)]}}],null,!0)})}))],2),n("div",{on:{dragover:e.onDragoverIngredients,drop:e.onDropIngredient}},[n("v-subheader",[e._v("Ingrédients additionnels")]),0==(e.menu.ingredients||[]).length?n("v-list-item",[n("v-list-item-subtitle",[n("i",[e._v("Cliquer-déplacer pour ajouter un ingrédient...")])])],1):e._e(),e._l(e.menu.ingredients,(function(t){return n("v-list-item",{key:t.id_ingredient,scopedSlots:e._u([{key:"default",fn:function(i){return[n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(e.getIngredient(t).nom)+" ")]),n("v-list-item-subtitle",[e._v(" "+e._s(t.quantite)+" "),n("i",[e._v(e._s(e.getIngredient(t).unite))]),e._v(" - Cuisson : "+e._s(t.cuisson)+" ")])],1),n("v-list-item-action",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"pencil",tooltip:"Modifier les détails...",color:"secondary"},on:{click:function(n){return n.stopPropagation(),e.editIngredient(t)}}})],1),n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"close",tooltip:"Retirer cet ingrédient du menu",color:"red"},on:{click:function(n){return n.stopPropagation(),e.removeIngredient(t)}}})],1)],1)],1)]}}],null,!0)})}))],2)])],1)},it=[],rt=(n("4160"),n("caad"),n("2532"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$emit("edit",e.current)}}},[n("v-card-title",{attrs:{"primary-title":""}},[e._v(" Détails de l'ingrédient ")]),n("v-card-text",[n("v-form",[n("v-row",[n("v-col",[n("v-text-field",{ref:"quantite",attrs:{label:"Quantité",hint:"Quantité désirée pour 1 personne.",type:"number"},model:{value:e.current.quantite,callback:function(t){e.$set(e.current,"quantite",e._n(t))},expression:"current.quantite"}})],1)],1),n("v-row",[n("v-col",[n("v-select",{attrs:{items:[],label:"Cuisson"},model:{value:e.current.cuisson,callback:function(t){e.$set(e.current,"cuisson",t)},expression:"current.cuisson"}})],1)],1)],1)],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"success"},on:{click:function(t){return e.$emit("edit",e.current)}}},[e._v("Valider")])],1)],1)}),at=[],ot=v["a"].extend({props:{ingredient:Object}}),st=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.current=Object(ye["b"])(e.ingredient),e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"onPropChange",value:function(){this.current=Object(ye["b"])(this.ingredient)}},{key:"focus",value:function(){var e=this.$refs.quantite.$el.querySelector("input");null!=e&&e.select()}}]),t}(ot);Object(m["a"])([Object(ee["a"])("ingredient")],st.prototype,"onPropChange",null),st=Object(m["a"])([Object(p["b"])({})],st);var ct=st,ut=ct,dt=Object(x["a"])(ut,rt,at,!1,null,"0c691b92",null),lt=dt.exports;V()(dt,{VBtn:C["a"],VCard:R["a"],VCardActions:M["a"],VCardText:M["c"],VCardTitle:M["d"],VCol:P["a"],VForm:Ce["a"],VRow:q["a"],VSelect:ce["a"],VSpacer:A["a"],VTextField:ge["a"]});var mt=v["a"].extend({props:{mode:String,initialMenu:Object}}),pt=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.menu=Object(ye["b"])(e.initialMenu),e.showEditIngredient=!1,e.editedIngredient=null,e.formatRecetteProprietaire=k["a"].formatter.formatMenuOrRecetteProprietaire,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"onMenuChange",value:function(){this.menu=Object(ye["b"])(this.initialMenu)}},{key:"getIngredient",value:function(e){return(k["a"].data.ingredients||{})[e.id_ingredient]}},{key:"removeRecette",value:function(e){this.menu.recettes=(this.menu.recettes||[]).filter((function(t){return t.id_recette!=e.id}))}},{key:"editIngredient",value:function(e){this.editedIngredient=e,this.showEditIngredient=!0}},{key:"editIngredientDone",value:function(e){var t=this,n=this.menu.ingredients;null!=n&&(n.forEach((function(i,r){i.id_ingredient==e.id_ingredient&&t.$set(n,r,e)})),this.showEditIngredient=!1)}},{key:"removeIngredient",value:function(e){this.menu.ingredients=(this.menu.ingredients||[]).filter((function(t){return t.id_ingredient!=e.id_ingredient}))}},{key:"onDragoverRecettes",value:function(e){if(e.dataTransfer){var t=e.dataTransfer.types.includes("id-recette");t&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")}}},{key:"onDropRecette",value:function(e){if(e.dataTransfer){e.preventDefault();var t=Number(e.dataTransfer.getData("id-recette")),n=this.menu.recettes||[],i=n.filter((function(e){return e.id_recette==t})).length>0;i||(n.push({id_menu:this.menu.id||-1,id_recette:t}),this.menu.recettes=n)}}},{key:"onDragoverIngredients",value:function(e){if(e.dataTransfer){var t=e.dataTransfer.types.includes("id-ingredient");t&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")}}},{key:"onDropIngredient",value:function(e){if(e.dataTransfer){e.preventDefault();var t,n=Number(e.dataTransfer.getData("id-ingredient")),i=this.menu.ingredients||[],r=i.filter((function(e){return e.id_ingredient==n}));r.length>0?t=r[0]:(t={id_menu:this.menu.id||-1,id_ingredient:n,quantite:0,cuisson:""},i.push(t),this.menu.ingredients=i),this.editedIngredient=t,this.showEditIngredient=!0}}},{key:"onEditIngredient",value:function(e){var t=this;e&&setTimeout((function(){var e=t.$refs.editIngredient;e&&e.focus()}),50)}},{key:"title",get:function(){return"edit"==this.mode?"Modifier le menu":"Ajouter un menu"}},{key:"recettes",get:function(){return k["a"].getMenuRecettes(this.menu)}}]),t}(mt);Object(m["a"])([Object(ee["a"])("initialMenu")],pt.prototype,"onMenuChange",null),Object(m["a"])([Object(ee["a"])("showEditIngredient")],pt.prototype,"onEditIngredient",null),pt=Object(m["a"])([Object(p["b"])({components:{TooltipBtn:g["a"],MenuOrRecetteIngredient:lt}})],pt);var vt=pt,ft=vt,ht=n("e0c7"),gt=(n("1681"),n("58df")),bt=Object(gt["a"])(ge["a"]),kt=bt.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:function(e){return!isNaN(parseFloat(e))}},rows:{type:[Number,String],default:5,validator:function(e){return!isNaN(parseInt(e,10))}}},computed:{classes:function(){return Object(a["a"])({"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle},ge["a"].options.computed.classes.call(this))},noResizeHandle:function(){return this.noResize||this.autoGrow}},watch:{lazyValue:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight:function(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted:function(){var e=this;setTimeout((function(){e.autoGrow&&e.calculateInputHeight()}),0)},methods:{calculateInputHeight:function(){var e=this.$refs.input;if(e){e.style.height="0";var t=e.scrollHeight,n=parseInt(this.rows,10)*parseFloat(this.rowHeight);e.style.height=Math.max(n,t)+"px"}},genInput:function(){var e=ge["a"].options.methods.genInput.call(this);return e.tag="textarea",delete e.data.attrs.type,e.data.attrs.rows=this.rows,e},onInput:function(e){ge["a"].options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown:function(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}}),yt=n("71d9"),It=n("2a7f"),wt=Object(x["a"])(ft,nt,it,!1,null,"72688d49",null),_t=wt.exports;V()(wt,{VCol:P["a"],VDialog:T["a"],VList:S["a"],VListItem:E["a"],VListItemAction:$["a"],VListItemContent:D["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:q["a"],VSpacer:A["a"],VSubheader:ht["a"],VTextarea:kt,VToolbar:yt["a"],VToolbarItems:It["a"],VToolbarTitle:It["b"]});var jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.showEditIngredient,callback:function(t){e.showEditIngredient=t},expression:"showEditIngredient"}},[n("menu-or-recette-ingredient",{ref:"editIngredient",attrs:{ingredient:e.editedIngredient},on:{edit:e.editIngredientDone}})],1),n("v-toolbar",{staticClass:"my-1",attrs:{color:"secondary",dense:""}},[n("v-toolbar-title",[e._v(e._s(e.title))]),n("v-spacer"),n("v-toolbar-items",[n("tooltip-btn",{attrs:{"mdi-icon":"check-outline",tooltip:"Valider",color:"success"},on:{click:function(t){return e.$emit("done",e.recette)}}}),n("tooltip-btn",{attrs:{"mdi-icon":"undo",tooltip:"Abandonner les modifications"},on:{click:function(t){return e.$emit("undo")}}})],1)],1),n("v-row",{staticClass:"px-2"},[n("v-col",[n("v-text-field",{attrs:{label:"Nom de la recette",required:""},model:{value:e.recette.nom,callback:function(t){e.$set(e.recette,"nom",t)},expression:"recette.nom"}}),n("v-textarea",{attrs:{label:"Mode d'emploi","hide-details":"",rows:"2"},model:{value:e.recette.mode_emploi,callback:function(t){e.$set(e.recette,"mode_emploi",t)},expression:"recette.mode_emploi"}})],1),n("v-col",[n("v-list",{staticClass:"mt-0 pt-0 overflow-y-auto",attrs:{dense:"","max-height":"60vh"}},[n("div",{on:{dragover:e.onDragoverIngredients,drop:e.onDropIngredient}},[n("v-subheader",[e._v("Ingrédients")]),0==(e.recette.ingredients||[]).length?n("v-list-item",[n("v-list-item-subtitle",[n("i",[e._v("Cliquer-déplacer pour ajouter un ingrédient...")])])],1):e._e(),e._l(e.recette.ingredients,(function(t){return n("v-list-item",{key:t.id_ingredient,scopedSlots:e._u([{key:"default",fn:function(i){return[n("v-list-item-content",[n("v-list-item-title",[e._v(" "+e._s(e.getIngredient(t).nom)+" ")]),n("v-list-item-subtitle",[e._v(" "+e._s(t.quantite)+" "),n("i",[e._v(e._s(e.getIngredient(t).unite))]),e._v(" - Cuisson : "+e._s(t.cuisson)+" ")])],1),n("v-list-item-action",[n("v-row",{attrs:{"no-gutters":""}},[n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"pencil",tooltip:"Modifier les détails...",color:"secondary"},on:{click:function(n){return n.stopPropagation(),e.editIngredient(t)}}})],1),n("v-col",[n("tooltip-btn",{attrs:{"mdi-icon":"close",tooltip:"Retirer cet ingrédient de la recette",color:"red"},on:{click:function(n){return n.stopPropagation(),e.removeIngredient(t)}}})],1)],1)],1)]}}],null,!0)})}))],2)])],1)],1)],1)},xt=[],Ot=v["a"].extend({props:{mode:String,initialRecette:Object}}),Vt=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.recette=Object(ye["b"])(e.initialRecette),e.showEditIngredient=!1,e.editedIngredient=null,e.formatRecetteProprietaire=k["a"].formatter.formatMenuOrRecetteProprietaire,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"onRecetteChange",value:function(){this.recette=Object(ye["b"])(this.initialRecette)}},{key:"getIngredient",value:function(e){return(k["a"].data.ingredients||{})[e.id_ingredient]}},{key:"editIngredient",value:function(e){this.editedIngredient=e,this.showEditIngredient=!0}},{key:"editIngredientDone",value:function(e){var t=this,n=this.recette.ingredients;null!=n&&(n.forEach((function(i,r){i.id_ingredient==e.id_ingredient&&t.$set(n,r,e)})),this.showEditIngredient=!1)}},{key:"removeIngredient",value:function(e){this.recette.ingredients=(this.recette.ingredients||[]).filter((function(t){return t.id_ingredient!=e.id_ingredient}))}},{key:"onDragoverIngredients",value:function(e){if(e.dataTransfer){var t=e.dataTransfer.types.includes("id-ingredient");t&&(e.preventDefault(),e.dataTransfer.dropEffect="copy")}}},{key:"onDropIngredient",value:function(e){if(e.dataTransfer){e.preventDefault();var t,n=Number(e.dataTransfer.getData("id-ingredient")),i=this.recette.ingredients||[],r=i.filter((function(e){return e.id_ingredient==n}));r.length>0?t=r[0]:(t={id_recette:this.recette.id,id_ingredient:n,quantite:0,cuisson:""},i.push(t),this.recette.ingredients=i),this.editedIngredient=t,this.showEditIngredient=!0}}},{key:"onEditIngredient",value:function(e){var t=this;e&&setTimeout((function(){var e=t.$refs.editIngredient;e&&e.focus()}),50)}},{key:"title",get:function(){return"edit"==this.mode?"Modifier la recette":"Ajouter une recette"}}]),t}(Ot);Object(m["a"])([Object(ee["a"])("initialRecette")],Vt.prototype,"onRecetteChange",null),Object(m["a"])([Object(ee["a"])("showEditIngredient")],Vt.prototype,"onEditIngredient",null),Vt=Object(m["a"])([Object(p["b"])({components:{TooltipBtn:g["a"],MenuOrRecetteIngredient:lt}})],Vt);var Ct=Vt,Rt=Ct,Mt=Object(x["a"])(Rt,jt,xt,!1,null,"05f36bb8",null),Pt=Mt.exports;V()(Mt,{VCol:P["a"],VDialog:T["a"],VList:S["a"],VListItem:E["a"],VListItemAction:$["a"],VListItemContent:D["a"],VListItemSubtitle:D["b"],VListItemTitle:D["c"],VRow:q["a"],VSpacer:A["a"],VSubheader:ht["a"],VTextField:ge["a"],VTextarea:kt,VToolbar:yt["a"],VToolbarItems:It["a"],VToolbarTitle:It["b"]});var Tt=function(e){function t(){var e;return Object(s["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.state={mode:"visu",selection:{idMenu:null,idRecette:null,idIngredient:null}},e.editMode="new",e.editedMenu=_e,e.editedRecette=we,e}return Object(l["a"])(t,e),Object(c["a"])(t,[{key:"mounted",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k["a"].data.loadAllMenus();case 2:null==k["a"].notifications.getError()&&k["a"].notifications.setMessage("Les menus, recettes et ingrédients ont bien été chargés."),this.selectIngredient();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"activated",value:function(){k["a"].notifications.getSpin()||this.selectIngredient()}},{key:"selectIngredient",value:function(){var e=Number(this.$route.query["idIngredient"]);e&&(this.state.mode="visu",this.state.selection.idRecette=null,this.state.selection.idMenu=null,this.$refs.listeIngredients.goToItem(e))}},{key:"startEditMenu",value:function(e){this.editedMenu=e,this.state.selection.idMenu=e.id,this.state.mode="editMenu",this.editMode="edit"}},{key:"startCreateMenu",value:function(){if(null!=k["a"].idUtilisateur){var e=Object(a["a"])({},Object(ye["b"])(_e),{id:-1});e.id_proprietaire.Int64=k["a"].idUtilisateur,this.editedMenu=e,this.editMode="new",this.state.mode="editMenu"}}},{key:"editMenuCancel",value:function(){this.state.mode="visu"}},{key:"editMenuDone",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n="","edit"!=this.editMode){e.next=8;break}return e.next=4,k["a"].data.updateMenu(t);case 4:t=e.sent,n="Le menu a bien été mis à jour.",e.next=12;break;case 8:return e.next=10,k["a"].data.createMenu(t);case 10:t=e.sent,n="Le menu a bien été ajouté.";case 12:this.state.mode="visu",null==k["a"].notifications.getError()&&(k["a"].notifications.setMessage(n),this.$nextTick((function(){i.$refs.listeMenus.goToItem(t.id)})));case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"startEditRecette",value:function(e){this.editedRecette=e,this.editMode="edit",this.state.mode="editRecette"}},{key:"startCreateRecette",value:function(){if(null!=k["a"].idUtilisateur){var e=Object(a["a"])({},Object(ye["b"])(we),{id:-1});e.id_proprietaire.Int64=k["a"].idUtilisateur,this.editedRecette=e,this.editMode="new",this.state.mode="editRecette"}}},{key:"editRecetteCancel",value:function(){this.state.mode="visu"}},{key:"editRecetteDone",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n="","edit"!=this.editMode){e.next=8;break}return e.next=4,k["a"].data.updateRecette(t);case 4:t=e.sent,n="La recette a bien été mise à jour.",e.next=12;break;case 8:return e.next=10,k["a"].data.createRecette(t);case 10:t=e.sent,n="La recette a bien été ajoutée.";case 12:this.state.mode="visu",null==k["a"].notifications.getError()&&(k["a"].notifications.setMessage(n),this.$refs.listeRecettes.goToItem(t.id));case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),t}(v["a"]);Tt=Object(m["a"])([Object(p["b"])({components:{ListeMenus:N,ListeRecettes:K,ListeIngredients:tt,EditMenu:_t,EditRecette:Pt}})],Tt);var St=Tt,Et=St,$t=n("a523"),Dt=Object(x["a"])(Et,i,r,!1,null,null,null);t["default"]=Dt.exports;V()(Dt,{VCol:P["a"],VContainer:$t["a"],VRow:q["a"]})}}]);
//# sourceMappingURL=menus.ad092779.js.map